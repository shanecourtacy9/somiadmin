"use strict";(self.webpackChunksomiadmin=self.webpackChunksomiadmin||[]).push([[458],{7633:(L,Z,o)=>{o.d(Z,{w:()=>x});var A=o(5e3),v=o(9826);let x=(()=>{class z{constructor(n,a){this.router=n,this.route=a}serializeQueryParams(n){const a={};if(a.pageIndex=(null==n?void 0:n.pageIndex)>1?n.pageIndex:void 0,10!=(null==n?void 0:n.pageSize)&&(a.pageSize=n.pageSize),null!=n.filter){const i=n.filter.filter(l=>null!=l.value&&l.value.length>0).map(l=>`${l.key}|${Array.isArray(l.value)?"in":"eq"}|${Array.isArray(l.value)?l.value.join("-"):l.value}`);a.filter=i.length>0?i.join(","):void 0}if(null!=n.sort&&n.sort.length>0){const i=n.sort.filter(l=>null!=l.value).map(l=>`${l.key}|${"ascend"==l.value?"ASC":"DESC"}`);a.sort=i.length>0?i.join(","):void 0}return a}onTableQueryParamsChange(n){const a=this.serializeQueryParams(n);this.router.navigate([],{relativeTo:this.route,queryParams:a,queryParamsHandling:"merge"})}filterText(n,a){var i;const c=null!==(i=this.deserializeQueryParams(this.route).filter)&&void 0!==i?i:{};c[n]=null!=a?{like:a}:{};const h=Object.keys(c).map(s=>{if(Object.keys(c[s]).length<1)return null;const u=Object.keys(c[s])[0];return`${s}|${u}|${"in"==u?c[s][u].join("-"):c[s][u]}`}).filter(s=>null!=s),p=h.length>0?h.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:p},queryParamsHandling:"merge"})}filterRange(n,a){var i;const c=null!==(i=this.deserializeQueryParams(this.route).filter)&&void 0!==i?i:{};c[n]=null!=a?{between:a}:{};const h=Object.keys(c).map(s=>{if(Object.keys(c[s]).length<1)return null;const u=Object.keys(c[s])[0];return`${s}|${u}|${"in"==u||"between"==u?c[s][u].join("-"):c[s][u]}`}).filter(s=>null!=s),p=h.length>0?h.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:p},queryParamsHandling:"merge"})}resetFilter(n,a){this.filterText(n,void 0),a.value=""}downloadURI(n,a){const i=document.createElement("a");i.download=a,i.href=n,i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)}deserializeQueryParams(n){var a;const i=n.sort?n.sort.split(",").map(p=>({field:p.split("|")[0],direction:p.split("|")[1]})):[],l={};null!=n.filter&&n.filter.split(",").forEach(p=>{const s={},u=p.split("|")[1];if("in"==u){const m=p.split("|")[2].split("-");s[u]=m}else if("between"==u){const m=p.split("|")[2].split("-");s[u]={lower:m[0],upper:m[1]}}else s[u]=p.split("|")[2];l[p.split("|")[0]]=s});const c=null!=n.pageIndex?parseInt(n.pageIndex):1,h=null!=n.pageSize?parseInt(n.pageSize):10;return{sorting:i.length>0?i:void 0,paging:{offset:null!==(a=(c-1)*h)&&void 0!==a?a:void 0,limit:h},filter:null!=l&&Object.keys(l).length>0?l:void 0}}}return z.\u0275fac=function(n){return new(n||z)(A.LFG(v.F0),A.LFG(v.gz))},z.\u0275prov=A.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},458:(L,Z,o)=>{o.r(Z),o.d(Z,{AdminTransactionsModule:()=>$});var A=o(6889),v=o(9826),x=o(655),_=o(4362),b=o(2340),z=o(4004),C=o(3905),n=o(5e3),a=o(7633),i=o(1945),l=o(6042),c=o(2643),h=o(2683),p=o(3677),s=o(647),u=o(4219),m=o(9808),T=o(939),O=o(404),I=o(1047),y=o(3075),Q=o(1062),M=o(8614);function U(e,d){if(1&e&&(n.TgZ(0,"a",24),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&e){const t=n.oxw().$implicit;n.Q6J("routerLink","/management/users/view/"+t.operatorId),n.xp6(1),n.Oqu(n.lcZ(2,2,"table.viewOperator"))}}function D(e,d){if(1&e&&(n.TgZ(0,"a",24),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&e){const t=n.oxw().$implicit;n.Q6J("routerLink","/requests/view/"+t.requestId),n.xp6(1),n.Oqu(n.lcZ(2,2,"table.viewRequest"))}}function J(e,d){if(1&e&&(n.TgZ(0,"tr")(1,"td",22),n.ALo(2,"date"),n._uU(3),n.ALo(4,"timeago"),n.qZA(),n.TgZ(5,"td"),n._uU(6),n.ALo(7,"translate"),n.ALo(8,"translate"),n.qZA(),n.TgZ(9,"td"),n._uU(10),n.ALo(11,"currency"),n.qZA(),n.TgZ(12,"td"),n._uU(13),n.qZA(),n.TgZ(14,"td"),n.YNc(15,U,3,4,"a",23),n.YNc(16,D,3,4,"a",23),n.qZA()()),2&e){const t=d.$implicit;n.xp6(1),n.Q6J("nz-tooltip",n.xi3(2,7,t.createdAt,"short")),n.xp6(2),n.hij(" ",n.lcZ(4,10,t.createdAt)," "),n.xp6(3),n.hij(" ","Deduct"===t.action?n.lcZ(7,12,"enum.transactionType."+t.deductType):n.lcZ(8,14,"enum.transactionType."+t.rechargeType)," "),n.xp6(4),n.Oqu(n.xi3(11,16,t.amount,t.currency)),n.xp6(3),n.Oqu(t.description),n.xp6(2),n.Q6J("ngIf",null!==t.operatorId),n.xp6(1),n.Q6J("ngIf",null!==t.requestId)}}function j(e,d){if(1&e){const t=n.EpF();n.TgZ(0,"nz-table",18,19),n.NdJ("nzQueryParams",function(g){return n.CHM(t),n.oxw(2).tableService.onTableQueryParamsChange(g)}),n.TgZ(2,"thead")(3,"tr")(4,"th",20),n._uU(5),n.ALo(6,"translate"),n.qZA(),n.TgZ(7,"th",21),n._uU(8),n.ALo(9,"translate"),n.qZA(),n.TgZ(10,"th"),n._uU(11),n.ALo(12,"translate"),n.qZA(),n.TgZ(13,"th"),n._uU(14),n.ALo(15,"translate"),n.qZA(),n.TgZ(16,"th"),n._uU(17),n.ALo(18,"translate"),n.qZA()()(),n.TgZ(19,"tbody"),n.YNc(20,J,17,19,"tr",17),n.qZA()()}if(2&e){const t=d.ngIf,r=n.MAs(1);n.Q6J("nzFrontPagination",!1)("nzData",t.nodes)("nzTotal",t.totalCount),n.xp6(5),n.hij(" ",n.lcZ(6,9,"profile.dateTime")," "),n.xp6(3),n.hij(" ",n.lcZ(9,11,"profile.transactionType")," "),n.xp6(3),n.Oqu(n.lcZ(12,13,"profile.amount")),n.xp6(3),n.Oqu(n.lcZ(15,15,"profile.details")),n.xp6(3),n.Oqu(n.lcZ(18,17,"profile.actions")),n.xp6(3),n.Q6J("ngForOf",r.data)}}function P(e,d){if(1&e&&(n.TgZ(0,"tr")(1,"td"),n._uU(2),n.ALo(3,"currency"),n.qZA()()),2&e){const t=d.$implicit;n.xp6(2),n.Oqu(n.xi3(3,1,t.balance,t.currency))}}function F(e,d){if(1&e&&(n.TgZ(0,"nz-page-header-content"),n.YNc(1,j,21,19,"nz-table",14),n.ALo(2,"async"),n.TgZ(3,"nz-table",15,16)(5,"thead")(6,"tr")(7,"th"),n._uU(8),n.ALo(9,"translate"),n.qZA()()(),n.TgZ(10,"tbody"),n.YNc(11,P,4,4,"tr",17),n.qZA()()()),2&e){const t=d.ngIf,r=n.MAs(4),g=n.oxw();let f;n.xp6(1),n.Q6J("ngIf",null==(f=n.lcZ(2,4,g.query))||null==f.data?null:f.data.providerTransactions),n.xp6(2),n.Q6J("nzData",t.providerWallets),n.xp6(5),n.Oqu(n.lcZ(9,6,"profile.total")),n.xp6(3),n.Q6J("ngForOf",r.data)}}let R=(()=>{class e{constructor(t,r,g){this.route=t,this.tableService=r,this.exportGql=g,this.amountRange=[-1,-1]}ngOnInit(){this.query=this.route.data.pipe((0,z.U)(t=>t.providerWallet)),this.currencies=this.query.pipe((0,z.U)(t=>this.distinctCurrency(t.data.regions.nodes).map(r=>({text:r,value:r}))))}exportTo(t){return(0,x.mG)(this,void 0,void 0,function*(){const r=yield(0,C.z)(this.exportGql.fetch({input:{table:_._bY.ProviderWallet,type:_.tM1.Csv}}));this.tableService.downloadURI(b.N.root+r.data.export.url,`export-${(new Date).getTime()}.csv`)})}distinctCurrency(t){return t.map(r=>r.currency).filter((r,g,f)=>f.indexOf(r)===g)}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(v.gz),n.Y36(a.w),n.Y36(_.gqb))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-admin-transactions"]],decls:28,vars:22,consts:[["nzBackIcon","","nzTitle","Provider Wallet","nzSubtitle","List of system provider (you) income of services.",3,"nzGhost"],["nz-button","","nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","export"],["nz-icon","","nzType","down"],["menuExport","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],[4,"ngIf"],["filteramount","nzDropdownMenu"],[1,"ant-table-filter-dropdown"],[1,"search-box"],["nz-input","","type","number",3,"placeholder","ngModel","ngModelChange"],["nz-button","","nzSize","small","nzType","default",1,"search-button",3,"click"],["nz-button","","nzSize","small",3,"click"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzBordered","",1,"mt-2",3,"nzData"],["summaryTable",""],[4,"ngFor","ngForOf"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams"],["table",""],["nzShowSort","","nzColumnKey","createdAt"],["nzShowSort","","nzColumnKey","action"],[3,"nz-tooltip"],[3,"routerLink",4,"ngIf"],[3,"routerLink"]],template:function(t,r){if(1&t&&(n.TgZ(0,"nz-page-header",0)(1,"nz-page-header-extra")(2,"button",1),n._UZ(3,"i",2),n._uU(4),n.ALo(5,"translate"),n._UZ(6,"i",3),n.qZA(),n.TgZ(7,"nz-dropdown-menu",null,4)(9,"ul",5)(10,"li",6),n.NdJ("click",function(){return r.exportTo("csv")}),n._uU(11,"CSV"),n.qZA()()()(),n.YNc(12,F,12,8,"nz-page-header-content",7),n.ALo(13,"async"),n.qZA(),n.TgZ(14,"nz-dropdown-menu",null,8)(16,"div",9)(17,"div",10)(18,"input",11),n.NdJ("ngModelChange",function(f){return r.amountRange[0]=f}),n.ALo(19,"translate"),n.qZA(),n.TgZ(20,"input",11),n.NdJ("ngModelChange",function(f){return r.amountRange[1]=f}),n.ALo(21,"translate"),n.qZA(),n.TgZ(22,"button",12),n.NdJ("click",function(){return r.tableService.filterRange("balance",r.amountRange)}),n._uU(23),n.ALo(24,"translate"),n.qZA(),n.TgZ(25,"button",13),n.NdJ("click",function(){return r.tableService.filterRange("balance",void 0)}),n._uU(26),n.ALo(27,"translate"),n.qZA()()()()),2&t){const g=n.MAs(8);let f;n.Q6J("nzGhost",!1),n.xp6(2),n.Q6J("nzDropdownMenu",g),n.xp6(2),n.hij(" ",n.lcZ(5,10,"profile.export")," "),n.xp6(8),n.Q6J("ngIf",null==(f=n.lcZ(13,12,r.query))?null:f.data),n.xp6(6),n.s9C("placeholder",n.lcZ(19,14,"table.min")),n.Q6J("ngModel",r.amountRange[0]),n.xp6(2),n.s9C("placeholder",n.lcZ(21,16,"table.max")),n.Q6J("ngModel",r.amountRange[1]),n.xp6(3),n.hij(" ",n.lcZ(24,18,"profile.search")," "),n.xp6(3),n.hij(" ",n.lcZ(27,20,"profile.reset")," ")}},directives:[i.$O,i.Jp,l.ix,c.dQ,h.w,p.wA,p.cm,s.Ls,p.RR,u.wO,u.r9,m.O5,i.u5,T.N8,T.Om,T.$Z,T.Uo,T._C,T.qD,T.p0,m.sg,O.SY,v.yS,I.Zp,y.wV,y.Fj,y.JJ,y.On],pipes:[Q.X$,m.Ov,m.uU,M.wr,m.H9],encapsulation:2}),e})(),S=(()=>{class e{constructor(t,r){this.paging=t,this.gql=r}resolve(t,r){const g=this.paging.deserializeQueryParams(t.queryParams);return this.gql.fetch(g)}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(a.w),n.LFG(_.rL6))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac}),e})();const q=[{path:"",component:R,resolve:{providerWallet:S},runGuardsAndResolvers:"paramsOrQueryParamsChange"}];let w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({providers:[S],imports:[[v.Bz.forChild(q)],v.Bz]}),e})(),$=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[w,A.m]]}),e})()}}]);