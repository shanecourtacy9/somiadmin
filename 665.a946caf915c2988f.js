"use strict";(self.webpackChunksomiadmin=self.webpackChunksomiadmin||[]).push([[665],{7633:(I,T,o)=>{o.d(T,{w:()=>A});var p=o(5e3),P=o(9826);let A=(()=>{class f{constructor(r,i){this.router=r,this.route=i}serializeQueryParams(r){const i={};if(i.pageIndex=(null==r?void 0:r.pageIndex)>1?r.pageIndex:void 0,10!=(null==r?void 0:r.pageSize)&&(i.pageSize=r.pageSize),null!=r.filter){const a=r.filter.filter(l=>null!=l.value&&l.value.length>0).map(l=>`${l.key}|${Array.isArray(l.value)?"in":"eq"}|${Array.isArray(l.value)?l.value.join("-"):l.value}`);i.filter=a.length>0?a.join(","):void 0}if(null!=r.sort&&r.sort.length>0){const a=r.sort.filter(l=>null!=l.value).map(l=>`${l.key}|${"ascend"==l.value?"ASC":"DESC"}`);i.sort=a.length>0?a.join(","):void 0}return i}onTableQueryParamsChange(r){const i=this.serializeQueryParams(r);this.router.navigate([],{relativeTo:this.route,queryParams:i,queryParamsHandling:"merge"})}filterText(r,i){var a;const s=null!==(a=this.deserializeQueryParams(this.route).filter)&&void 0!==a?a:{};s[r]=null!=i?{like:i}:{};const h=Object.keys(s).map(u=>{if(Object.keys(s[u]).length<1)return null;const d=Object.keys(s[u])[0];return`${u}|${d}|${"in"==d?s[u][d].join("-"):s[u][d]}`}).filter(u=>null!=u),v=h.length>0?h.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:v},queryParamsHandling:"merge"})}filterRange(r,i){var a;const s=null!==(a=this.deserializeQueryParams(this.route).filter)&&void 0!==a?a:{};s[r]=null!=i?{between:i}:{};const h=Object.keys(s).map(u=>{if(Object.keys(s[u]).length<1)return null;const d=Object.keys(s[u])[0];return`${u}|${d}|${"in"==d||"between"==d?s[u][d].join("-"):s[u][d]}`}).filter(u=>null!=u),v=h.length>0?h.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:v},queryParamsHandling:"merge"})}resetFilter(r,i){this.filterText(r,void 0),i.value=""}downloadURI(r,i){const a=document.createElement("a");a.download=i,a.href=r,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)}deserializeQueryParams(r){var i;const a=r.sort?r.sort.split(",").map(v=>({field:v.split("|")[0],direction:v.split("|")[1]})):[],l={};null!=r.filter&&r.filter.split(",").forEach(v=>{const u={},d=v.split("|")[1];if("in"==d){const z=v.split("|")[2].split("-");u[d]=z}else if("between"==d){const z=v.split("|")[2].split("-");u[d]={lower:z[0],upper:z[1]}}else u[d]=v.split("|")[2];l[v.split("|")[0]]=u});const s=null!=r.pageIndex?parseInt(r.pageIndex):1,h=null!=r.pageSize?parseInt(r.pageSize):10;return{sorting:a.length>0?a:void 0,paging:{offset:null!==(i=(s-1)*h)&&void 0!==i?i:void 0,limit:h},filter:null!=l&&Object.keys(l).length>0?l:void 0}}}return f.\u0275fac=function(r){return new(r||f)(p.LFG(P.F0),p.LFG(P.gz))},f.\u0275prov=p.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},7665:(I,T,o)=>{o.r(T),o.d(T,{ManagementReviewParametersModule:()=>B});var p=o(9826),P=o(5233),A=o(4004),e=o(5e3),S=o(7633),f=o(1945),R=o(6042),r=o(2643),i=o(2683),a=o(647),l=o(9808),s=o(939),h=o(8481),v=o(1062);function u(t,m){if(1&t&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td")(4,"nz-tag",7),e._uU(5),e.qZA()(),e.TgZ(6,"td")(7,"a",8),e._uU(8),e.ALo(9,"translate"),e.qZA()()()),2&t){const n=m.$implicit,c=e.oxw(2);e.xp6(2),e.Oqu(n.title),e.xp6(2),e.Q6J("nzColor",c.tagColor.boolean(n.isGood)),e.xp6(1),e.Oqu(n.isGood?"Good":"Bad"),e.xp6(2),e.Q6J("routerLink","view/"+n.id),e.xp6(1),e.Oqu(e.lcZ(9,5,"profile.view"))}}function d(t,m){if(1&t&&(e.TgZ(0,"nz-table",4,5)(2,"thead")(3,"tr")(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Type"),e.qZA(),e.TgZ(9,"th"),e._uU(10),e.ALo(11,"translate"),e.qZA()()(),e.TgZ(12,"tbody"),e.YNc(13,u,10,7,"tr",6),e.qZA()()),2&t){const n=m.ngIf,c=e.MAs(1);e.Q6J("nzFrontPagination",!1)("nzData",n)("nzTotal",n.length),e.xp6(5),e.Oqu(e.lcZ(6,6,"profile.name")),e.xp6(5),e.Oqu(e.lcZ(11,8,"profile.actions")),e.xp6(3),e.Q6J("ngForOf",c.data)}}let z=(()=>{class t{constructor(n,c,g,C){this.route=n,this.tableService=c,this.router=g,this.tagColor=C}ngOnInit(){this.query=this.route.data.pipe((0,A.U)(n=>n.reviewParameters))}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(p.gz),e.Y36(S.w),e.Y36(p.F0),e.Y36(P.k))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-review-parameters-list"]],decls:9,vars:7,consts:[["nzBackIcon","","nzTitle","Review Parameters","nzSubtitle","List of parameters that rider can assign to the service experience",3,"nzGhost"],["nz-button","","nzType","default","routerLink","new"],["nz-icon","","nzType","plus"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal"],["ajaxTable",""],[4,"ngFor","ngForOf"],[3,"nzColor"],[3,"routerLink"]],template:function(n,c){if(1&n&&(e.TgZ(0,"nz-page-header",0)(1,"nz-page-header-extra")(2,"button",1),e._UZ(3,"i",2),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"nz-page-header-content"),e.YNc(7,d,14,10,"nz-table",3),e.ALo(8,"async"),e.qZA()()),2&n){let g;e.Q6J("nzGhost",!1),e.xp6(4),e.hij("",e.lcZ(5,3,"profile.add")," "),e.xp6(3),e.Q6J("ngIf",null==(g=e.lcZ(8,5,c.query))||null==g.data?null:g.data.feedbackParameters)}},directives:[f.$O,f.Jp,R.ix,r.dQ,i.w,p.rH,a.Ls,f.u5,l.O5,s.N8,s.Om,s.$Z,s.Uo,s._C,s.p0,l.sg,h.j,p.yS],pipes:[v.X$,l.Ov],encapsulation:2}),t})();var Z=o(4362);let x=(()=>{class t{constructor(n,c){this.paging=n,this.gql=c}resolve(n,c){return this.gql.fetch()}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(S.w),e.LFG(Z.Crj))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();var b=o(655),w=o(3075),L=o(3905),M=o(9727),Q=o(7484),y=o(4546),F=o(1894),j=o(1047),D=o(6462);function U(t,m){if(1&t){const n=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){return e.CHM(n),e.oxw().onSubmit()}),e._uU(1," Save "),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("disabled",n.form.invalid)}}const J=function(t){return[t]};let O=(()=>{class t{constructor(n,c,g,C,E,N){this.route=n,this.router=c,this.fb=g,this.createGQL=C,this.updateGQL=E,this.msg=N,this.form=this.fb.group({id:[null],title:[null,w.kI.required],isGood:[null,w.kI.required]})}ngAfterViewInit(){this.initializeDrawingManager()}initializeDrawingManager(){this.route.data.subscribe(n=>{if(null!=n.reviewParameter){const g=n.reviewParameter.data.feedbackParameter;null!=g&&this.form.patchValue(g)}})}onSubmit(){return(0,b.mG)(this,void 0,void 0,function*(){try{const n=this.form.value,{id:c}=n,g=(0,b._T)(n,["id"]);null==c?yield(0,L.z)(this.createGQL.mutate({input:g})):yield(0,L.z)(this.updateGQL.mutate({id:c,update:g})),this.router.navigate(["management/review-parameters"],{relativeTo:this.route.root})}catch(n){this.msg.error(n.message)}})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(p.gz),e.Y36(p.F0),e.Y36(w.qu),e.Y36(Z.KXg),e.Y36(Z.v1o),e.Y36(M.dD))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-review-parameter-view"]],decls:16,vars:5,consts:[["nzBackIcon","","nzTitle","New Review Parameter","nzSubtitle","Pramaters of reviews that rider can select for his rating.",3,"nzGhost"],[3,"nzActions"],["nz-form","",3,"formGroup","ngSubmit"],["formControlName","id","type","hidden","hidden",""],["nzRequired","","nzFor","title"],["nzErrorTip","The input is not valid name"],["nz-input","","formControlName","title","id","title"],["nzFor","isGood","nzRequired",""],["formControlName","isGood","id","isGood"],["tmplActions",""],["nz-button","","nzType","default",3,"disabled","click"]],template:function(n,c){if(1&n&&(e._UZ(0,"nz-page-header",0),e.TgZ(1,"nz-card",1)(2,"form",2),e.NdJ("ngSubmit",function(){return c.onSubmit()}),e._UZ(3,"input",3),e.TgZ(4,"nz-form-item")(5,"nz-form-label",4),e._uU(6,"Title"),e.qZA(),e.TgZ(7,"nz-form-control",5),e._UZ(8,"input",6),e.qZA()(),e.TgZ(9,"nz-form-item")(10,"nz-form-label",7),e._uU(11,"Is Good"),e.qZA(),e.TgZ(12,"nz-form-control"),e._UZ(13,"nz-switch",8),e.qZA()(),e.YNc(14,U,2,1,"ng-template",null,9,e.W1O),e.qZA()()),2&n){const g=e.MAs(15);e.Q6J("nzGhost",!1),e.xp6(1),e.Q6J("nzActions",e.VKq(3,J,g)),e.xp6(1),e.Q6J("formGroup",c.form)}},directives:[f.$O,Q.bd,w._Y,w.JL,y.Lr,w.sg,w.Fj,w.JJ,w.u,F.SK,y.Nx,F.t3,y.iK,y.Fd,j.Zp,D.i,R.ix,r.dQ,i.w],encapsulation:2}),t})(),G=(()=>{class t{constructor(n){this.gql=n}resolve(n,c){return this.gql.fetch({id:n.params.id})}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(Z.B4c))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();const Y=[{path:"",component:z,resolve:{reviewParameters:x},runGuardsAndResolvers:"paramsOrQueryParamsChange"},{path:"view/:id",component:O,resolve:{reviewParameter:G}},{path:"new",component:O}];let V=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[x,G],imports:[[p.Bz.forChild(Y)],p.Bz]}),t})();var $=o(6889);let B=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[P.k],imports:[[V,$.m]]}),t})()}}]);