"use strict";(self.webpackChunksomiadmin=self.webpackChunksomiadmin||[]).push([[507],{7633:(L,Z,o)=>{o.d(Z,{w:()=>C});var F=o(5e3),y=o(9826);let C=(()=>{class z{constructor(e,r){this.router=e,this.route=r}serializeQueryParams(e){const r={};if(r.pageIndex=(null==e?void 0:e.pageIndex)>1?e.pageIndex:void 0,10!=(null==e?void 0:e.pageSize)&&(r.pageSize=e.pageSize),null!=e.filter){const a=e.filter.filter(i=>null!=i.value&&i.value.length>0).map(i=>`${i.key}|${Array.isArray(i.value)?"in":"eq"}|${Array.isArray(i.value)?i.value.join("-"):i.value}`);r.filter=a.length>0?a.join(","):void 0}if(null!=e.sort&&e.sort.length>0){const a=e.sort.filter(i=>null!=i.value).map(i=>`${i.key}|${"ascend"==i.value?"ASC":"DESC"}`);r.sort=a.length>0?a.join(","):void 0}return r}onTableQueryParamsChange(e){const r=this.serializeQueryParams(e);this.router.navigate([],{relativeTo:this.route,queryParams:r,queryParamsHandling:"merge"})}filterText(e,r){var a;const u=null!==(a=this.deserializeQueryParams(this.route).filter)&&void 0!==a?a:{};u[e]=null!=r?{like:r}:{};const h=Object.keys(u).map(s=>{if(Object.keys(u[s]).length<1)return null;const c=Object.keys(u[s])[0];return`${s}|${c}|${"in"==c?u[s][c].join("-"):u[s][c]}`}).filter(s=>null!=s),p=h.length>0?h.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:p},queryParamsHandling:"merge"})}filterRange(e,r){var a;const u=null!==(a=this.deserializeQueryParams(this.route).filter)&&void 0!==a?a:{};u[e]=null!=r?{between:r}:{};const h=Object.keys(u).map(s=>{if(Object.keys(u[s]).length<1)return null;const c=Object.keys(u[s])[0];return`${s}|${c}|${"in"==c||"between"==c?u[s][c].join("-"):u[s][c]}`}).filter(s=>null!=s),p=h.length>0?h.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:p},queryParamsHandling:"merge"})}resetFilter(e,r){this.filterText(e,void 0),r.value=""}downloadURI(e,r){const a=document.createElement("a");a.download=r,a.href=e,a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)}deserializeQueryParams(e){var r;const a=e.sort?e.sort.split(",").map(p=>({field:p.split("|")[0],direction:p.split("|")[1]})):[],i={};null!=e.filter&&e.filter.split(",").forEach(p=>{const s={},c=p.split("|")[1];if("in"==c){const g=p.split("|")[2].split("-");s[c]=g}else if("between"==c){const g=p.split("|")[2].split("-");s[c]={lower:g[0],upper:g[1]}}else s[c]=p.split("|")[2];i[p.split("|")[0]]=s});const u=null!=e.pageIndex?parseInt(e.pageIndex):1,h=null!=e.pageSize?parseInt(e.pageSize):10;return{sorting:a.length>0?a:void 0,paging:{offset:null!==(r=(u-1)*h)&&void 0!==r?r:void 0,limit:h},filter:null!=i&&Object.keys(i).length>0?i:void 0}}}return z.\u0275fac=function(e){return new(e||z)(F.LFG(y.F0),F.LFG(y.gz))},z.\u0275prov=F.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},6507:(L,Z,o)=>{o.r(Z),o.d(Z,{FleetWalletsModule:()=>J});var F=o(6889),y=o(9826),C=o(655),T=o(4362),S=o(2340),z=o(4004),_=o(3905),e=o(5e3),r=o(7633),a=o(1945),i=o(6042),u=o(2643),h=o(2683),p=o(3677),s=o(647),c=o(4219),g=o(9808),v=o(939),M=o(1047),A=o(3075),W=o(1062);function O(n,f){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td")(9,"a",22),e._uU(10),e.ALo(11,"translate"),e.qZA()()()),2&n){const t=f.$implicit;e.xp6(2),e.Oqu(t.fleet.name),e.xp6(2),e.Oqu(e.xi3(5,5,t.balance,t.currency)),e.xp6(3),e.Oqu(t.currency),e.xp6(2),e.Q6J("routerLink","/management/fleets/view/"+t.fleetId),e.xp6(1),e.Oqu(e.lcZ(11,8,"table.viewFleet"))}}const D=function(){return[]};function Q(n,f){if(1&n){const t=e.EpF();e.TgZ(0,"nz-table",15,16),e.NdJ("nzQueryParams",function(d){return e.CHM(t),e.oxw(2).tableService.onTableQueryParamsChange(d)}),e.TgZ(2,"thead")(3,"tr")(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th",17),e._uU(8),e.ALo(9,"translate"),e.TgZ(10,"nz-filter-trigger",18),e._UZ(11,"i",19),e.qZA()(),e.TgZ(12,"th",20),e.ALo(13,"async"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA()()(),e.TgZ(19,"tbody"),e.YNc(20,O,12,10,"tr",21),e.qZA()()}if(2&n){const t=f.ngIf,l=e.MAs(1),d=e.oxw(2),m=e.MAs(15);let x;e.Q6J("nzFrontPagination",!1)("nzData",t.nodes)("nzTotal",t.totalCount),e.xp6(5),e.Oqu(e.lcZ(6,12,"profile.name")),e.xp6(3),e.hij(" ",e.lcZ(9,14,"profile.amount")," "),e.xp6(2),e.Q6J("nzActive",-1!==d.amountRange[0])("nzDropdownMenu",m),e.xp6(2),e.Q6J("nzFilters",null!==(x=e.lcZ(13,16,d.currencies))&&void 0!==x?x:e.DdM(22,D))("nzFilterFn",!0),e.xp6(2),e.hij(" ",e.lcZ(15,18,"profile.currency")," "),e.xp6(3),e.Oqu(e.lcZ(18,20,"profile.actions")),e.xp6(3),e.Q6J("ngForOf",l.data)}}function w(n,f){if(1&n&&(e.TgZ(0,"nz-page-header-content"),e.YNc(1,Q,21,23,"nz-table",14),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw();let l;e.xp6(1),e.Q6J("ngIf",null==(l=e.lcZ(2,1,t.query))||null==l.data?null:l.data.fleetWallets)}}let j=(()=>{class n{constructor(t,l,d){this.route=t,this.tableService=l,this.exportGql=d,this.amountRange=[-1,-1]}ngOnInit(){this.query=this.route.data.pipe((0,z.U)(t=>t.fleetWallet)),this.currencies=this.query.pipe((0,z.U)(t=>this.distinctCurrency(t.data.regions.nodes).map(l=>({text:l,value:l}))))}exportTo(t){return(0,C.mG)(this,void 0,void 0,function*(){const l=yield(0,_.z)(this.exportGql.fetch({input:{table:T._bY.FleetWallet,type:T.tM1.Csv}}));this.tableService.downloadURI(S.N.root+l.data.export.url,`export-${(new Date).getTime()}.csv`)})}distinctCurrency(t){return t.map(l=>l.currency).filter((l,d,m)=>m.indexOf(l)===d)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(y.gz),e.Y36(r.w),e.Y36(T.gqb))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-fleet-wallets-list"]],decls:28,vars:22,consts:[["nzBackIcon","","nzTitle","Fleet Wallets","nzSubtitle","List of fleets current wallet balance",3,"nzGhost"],["nz-button","","nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","export"],["nz-icon","","nzType","down"],["menuExport","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],[4,"ngIf"],["filteramount","nzDropdownMenu"],[1,"ant-table-filter-dropdown"],[1,"search-box"],["nz-input","","type","number",3,"placeholder","ngModel","ngModelChange"],["nz-button","","nzSize","small","nzType","default",1,"search-button",3,"click"],["nz-button","","nzSize","small",3,"click"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams"],["table",""],["nzShowSort","","nzColumnKey","amount","nzCustomFilter",""],[3,"nzActive","nzDropdownMenu"],["nz-icon","","nzType","search"],["nzShowSort","","nzColumnKey","currency","nzShowFilter","",3,"nzFilters","nzFilterFn"],[4,"ngFor","ngForOf"],[3,"routerLink"]],template:function(t,l){if(1&t&&(e.TgZ(0,"nz-page-header",0)(1,"nz-page-header-extra")(2,"button",1),e._UZ(3,"i",2),e._uU(4),e.ALo(5,"translate"),e._UZ(6,"i",3),e.qZA(),e.TgZ(7,"nz-dropdown-menu",null,4)(9,"ul",5)(10,"li",6),e.NdJ("click",function(){return l.exportTo("csv")}),e._uU(11,"CSV"),e.qZA()()()(),e.YNc(12,w,3,3,"nz-page-header-content",7),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"nz-dropdown-menu",null,8)(16,"div",9)(17,"div",10)(18,"input",11),e.NdJ("ngModelChange",function(m){return l.amountRange[0]=m}),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"input",11),e.NdJ("ngModelChange",function(m){return l.amountRange[1]=m}),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"button",12),e.NdJ("click",function(){return l.tableService.filterRange("balance",l.amountRange)}),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"button",13),e.NdJ("click",function(){return l.tableService.filterRange("balance",void 0)}),e._uU(26),e.ALo(27,"translate"),e.qZA()()()()),2&t){const d=e.MAs(8);let m;e.Q6J("nzGhost",!1),e.xp6(2),e.Q6J("nzDropdownMenu",d),e.xp6(2),e.hij(" ",e.lcZ(5,10,"profile.export")," "),e.xp6(8),e.Q6J("ngIf",null==(m=e.lcZ(13,12,l.query))?null:m.data),e.xp6(6),e.s9C("placeholder",e.lcZ(19,14,"table.min")),e.Q6J("ngModel",l.amountRange[0]),e.xp6(2),e.s9C("placeholder",e.lcZ(21,16,"table.max")),e.Q6J("ngModel",l.amountRange[1]),e.xp6(3),e.hij(" ",e.lcZ(24,18,"profile.search")," "),e.xp6(3),e.hij(" ",e.lcZ(27,20,"profile.reset")," ")}},directives:[a.$O,a.Jp,i.ix,u.dQ,h.w,p.wA,p.cm,s.Ls,p.RR,c.wO,c.r9,g.O5,a.u5,v.N8,v.Om,v.$Z,v.Uo,v._C,v.qD,v.Ql,v.p0,g.sg,y.yS,M.Zp,A.wV,A.Fj,A.JJ,A.On],pipes:[W.X$,g.Ov,g.H9],encapsulation:2}),n})(),b=(()=>{class n{constructor(t,l){this.paging=t,this.gql=l}resolve(t,l){const d=this.paging.deserializeQueryParams(t.queryParams);return this.gql.fetch(d)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(r.w),e.LFG(T.vC$))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();const R=[{path:"",component:j,resolve:{fleetWallet:b},runGuardsAndResolvers:"paramsOrQueryParamsChange"}];let I=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[b],imports:[[y.Bz.forChild(R)],y.Bz]}),n})(),J=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[I,F.m]]}),n})()}}]);