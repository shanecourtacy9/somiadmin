"use strict";(self.webpackChunksomiadmin=self.webpackChunksomiadmin||[]).push([[107],{7633:(R,y,l)=>{l.d(y,{w:()=>f});var D=l(5e3),e=l(9826);let f=(()=>{class v{constructor(s,c){this.router=s,this.route=c}serializeQueryParams(s){const c={};if(c.pageIndex=(null==s?void 0:s.pageIndex)>1?s.pageIndex:void 0,10!=(null==s?void 0:s.pageSize)&&(c.pageSize=s.pageSize),null!=s.filter){const p=s.filter.filter(u=>null!=u.value&&u.value.length>0).map(u=>`${u.key}|${Array.isArray(u.value)?"in":"eq"}|${Array.isArray(u.value)?u.value.join("-"):u.value}`);c.filter=p.length>0?p.join(","):void 0}if(null!=s.sort&&s.sort.length>0){const p=s.sort.filter(u=>null!=u.value).map(u=>`${u.key}|${"ascend"==u.value?"ASC":"DESC"}`);c.sort=p.length>0?p.join(","):void 0}return c}onTableQueryParamsChange(s){const c=this.serializeQueryParams(s);this.router.navigate([],{relativeTo:this.route,queryParams:c,queryParamsHandling:"merge"})}filterText(s,c){var p;const d=null!==(p=this.deserializeQueryParams(this.route).filter)&&void 0!==p?p:{};d[s]=null!=c?{like:c}:{};const T=Object.keys(d).map(m=>{if(Object.keys(d[m]).length<1)return null;const h=Object.keys(d[m])[0];return`${m}|${h}|${"in"==h?d[m][h].join("-"):d[m][h]}`}).filter(m=>null!=m),z=T.length>0?T.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:z},queryParamsHandling:"merge"})}filterRange(s,c){var p;const d=null!==(p=this.deserializeQueryParams(this.route).filter)&&void 0!==p?p:{};d[s]=null!=c?{between:c}:{};const T=Object.keys(d).map(m=>{if(Object.keys(d[m]).length<1)return null;const h=Object.keys(d[m])[0];return`${m}|${h}|${"in"==h||"between"==h?d[m][h].join("-"):d[m][h]}`}).filter(m=>null!=m),z=T.length>0?T.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:z},queryParamsHandling:"merge"})}resetFilter(s,c){this.filterText(s,void 0),c.value=""}downloadURI(s,c){const p=document.createElement("a");p.download=c,p.href=s,p.target="_blank",document.body.appendChild(p),p.click(),document.body.removeChild(p)}deserializeQueryParams(s){var c;const p=s.sort?s.sort.split(",").map(z=>({field:z.split("|")[0],direction:z.split("|")[1]})):[],u={};null!=s.filter&&s.filter.split(",").forEach(z=>{const m={},h=z.split("|")[1];if("in"==h){const _=z.split("|")[2].split("-");m[h]=_}else if("between"==h){const _=z.split("|")[2].split("-");m[h]={lower:_[0],upper:_[1]}}else m[h]=z.split("|")[2];u[z.split("|")[0]]=m});const d=null!=s.pageIndex?parseInt(s.pageIndex):1,T=null!=s.pageSize?parseInt(s.pageSize):10;return{sorting:p.length>0?p:void 0,paging:{offset:null!==(c=(d-1)*T)&&void 0!==c?c:void 0,limit:T},filter:null!=u&&Object.keys(u).length>0?u:void 0}}}return v.\u0275fac=function(s){return new(s||v)(D.LFG(e.F0),D.LFG(e.gz))},v.\u0275prov=D.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},5107:(R,y,l)=>{l.r(y),l.d(y,{DispatcherModule:()=>pe});var D=l(6889),e=l(5e3),f=l(9826),L=l(9727),N=l(7957),v=l(1062),b=l(7484),s=l(2013);let c=(()=>{class n{constructor(t,i,r,a,g){this.router=t,this.route=i,this.messageService=r,this.modal=a,this.translate=g,this.current=0,this.services=[],this.tripDistance=0,this.tripDuration=0,this.isLoadingRiders=!1}ngOnInit(){this.route.queryParams.subscribe(t=>{null!=t.serviceId?this.current=3:null!=t.points?this.current=2:null!=t.riderId&&(this.selectedRiderId=parseInt(t.riderId),this.current=1)})}viewRequest(t){this.router.navigate(["../../../requests/view",t],{relativeTo:this.route})}refreshDrivers(){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.F0),e.Y36(f.gz),e.Y36(L.dD),e.Y36(N.Sf),e.Y36(v.sK))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dispatcher"]],decls:17,vars:25,consts:[[1,"grid","grid-cols-1"],[3,"nzCurrent"],[3,"nzTitle","nzDescription"],[1,"h-4","w-full"]],template:function(t,i){1&t&&(e.TgZ(0,"nz-card"),e._UZ(1,"div",0),e.TgZ(2,"nz-steps",1),e._UZ(3,"nz-step",2),e.ALo(4,"translate"),e.ALo(5,"translate"),e._UZ(6,"nz-step",2),e.ALo(7,"translate"),e.ALo(8,"translate"),e._UZ(9,"nz-step",2),e.ALo(10,"translate"),e.ALo(11,"translate"),e._UZ(12,"nz-step",2),e.ALo(13,"translate"),e.ALo(14,"translate"),e.qZA(),e._UZ(15,"div",3)(16,"router-outlet"),e.qZA()),2&t&&(e.xp6(2),e.Q6J("nzCurrent",i.current),e.xp6(1),e.s9C("nzTitle",e.lcZ(4,9,"dispatcher.rider.title")),e.s9C("nzDescription",e.lcZ(5,11,"dispatcher.rider.description")),e.xp6(3),e.s9C("nzTitle",e.lcZ(7,13,"dispatcher.location.title")),e.s9C("nzDescription",e.lcZ(8,15,"dispatcher.location.description")),e.xp6(3),e.s9C("nzTitle",e.lcZ(10,17,"dispatcher.service.title")),e.s9C("nzDescription",e.lcZ(11,19,"dispatcher.service.description")),e.xp6(3),e.s9C("nzTitle",e.lcZ(13,21,"dispatcher.looking.title")),e.s9C("nzDescription",e.lcZ(14,23,"dispatcher.looking.description")))},directives:[b.bd,s.iy,s.$W,f.lC],pipes:[v.X$],encapsulation:2}),n})();var p=l(4739),u=l(655),d=l(3315),T=l(1047),z=l(3075);const m=["addresstext"];let h=(()=>{class n{constructor(){this.setAddress=new e.vpe}ngAfterViewInit(){this.getPlaceAutocomplete()}getPlaceAutocomplete(){this.autocompleteObject=new google.maps.places.Autocomplete(this.addresstext.nativeElement,{types:[this.adressType]}),google.maps.event.addListener(this.autocompleteObject,"place_changed",()=>{const t=this.autocompleteObject.getPlace();this.invokeEvent(t)})}setBounds(t){this.autocompleteObject.setBounds(t)}invokeEvent(t){this.setAddress.emit(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["google-places-autocomplete"]],viewQuery:function(t,i){if(1&t&&e.Gf(m,5),2&t){let r;e.iGM(r=e.CRH())&&(i.addresstext=r.first)}},inputs:{adressType:"adressType"},outputs:{setAddress:"setAddress"},decls:2,vars:1,consts:[["type","text","nz-input","",1,"input",2,"width","100%","margin-top","10px","margin-bottom","10px",3,"ngModel","ngModelChange"],["addresstext",""]],template:function(t,i){1&t&&(e.TgZ(0,"input",0,1),e.NdJ("ngModelChange",function(a){return i.autocompleteInput=a}),e.qZA()),2&t&&e.Q6J("ngModel",i.autocompleteInput)},directives:[T.Zp,z.Fj,z.JJ,z.On],encapsulation:2}),n})(),_=(()=>{class n{serializePoints(t){return t.map(i=>`${i.location.lat}|${i.location.lng}|${i.address}`).join("_")}deserializePoints(t){return t.split("_").map(i=>({location:{lat:parseFloat(i.split("|")[0]),lng:parseFloat(i.split("|")[1])},address:i.split("|")[2]}))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var C=l(9808),M=l(2712),F=l(6042),I=l(2643),O=l(2683);const Q=function(){return{draggable:!1}};function Y(n,o){if(1&n&&e._UZ(0,"map-marker",7,8),2&n){const t=o.$implicit;e.Q6J("position",t.location)("options",e.DdM(3,Q))("title",t.driverId.toString())}}function w(n,o){if(1&n&&e._UZ(0,"map-marker",7),2&n){const t=o.$implicit;e.Q6J("position",t.location)("options",e.DdM(3,Q))("title",t.address)}}function j(n,o){if(1&n&&(e.TgZ(0,"nz-timeline-item"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(t.address)}}let $=(()=>{class n{constructor(t,i,r,a,g){this.messageService=t,this.translate=i,this.route=r,this.router=a,this.dispatcherService=g,this.points=[],this.drivers=[]}getAddress(t){this.map.panTo(t.geometry.location)}removeLastPoint(){this.points.pop()}mapClicked(t){return(0,u.mG)(this,void 0,void 0,function*(){const i=new google.maps.Geocoder,r=this.messageService.loading(this.translate.instant("dispatcher.determiningLocation"),{nzDuration:0}).messageId;i.geocode({location:t.latLng},(a,g)=>{var S;t.latLng&&(this.points.push({location:null===(S=t.latLng)||void 0===S?void 0:S.toJSON(),address:a[0].formatted_address}),this.messageService.remove(r))})})}goToServiceSelection(){this.router.navigate(["../service-select"],{relativeTo:this.route,queryParams:{points:this.dispatcherService.serializePoints(this.points)},queryParamsHandling:"merge"})}centerMap(){if(0==this.drivers.length)return void(this.map.zoom=1);if(1==this.drivers.length)return this.map.center=this.drivers[0].location,void(this.map.zoom=16);const t=new google.maps.LatLngBounds;for(const r of this.drivers)t.extend(r.location);const i=new google.maps.LatLngBounds(new google.maps.LatLng(t.getSouthWest().lat()-2,t.getSouthWest().lng()-2),new google.maps.LatLng(t.getNorthEast().lat()+2,t.getNorthEast().lng()+2));this.places.setBounds(i),this.map.fitBounds(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(L.dD),e.Y36(v.sK),e.Y36(f.gz),e.Y36(f.F0),e.Y36(_))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dispatcher-locations-select"]],viewQuery:function(t,i){if(1&t&&(e.Gf(d.ch,5),e.Gf(d.b6,5),e.Gf(h,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.infoWindow=r.first),e.iGM(r=e.CRH())&&(i.map=r.first),e.iGM(r=e.CRH())&&(i.places=r.first)}},decls:15,vars:10,consts:[["adressType","geocode",3,"setAddress"],["height","700px","width","100%",3,"mapClick"],[3,"position","options","title",4,"ngFor","ngForOf"],[1,"pt-16"],[4,"ngFor","ngForOf"],["nz-button","","nzDanger","",2,"margin-top","8px","margin-right","4px",3,"click"],["nz-button","","nzType","default",2,"margin-top","8px",3,"disabled","click"],[3,"position","options","title"],["marker",""]],template:function(t,i){1&t&&(e.TgZ(0,"google-places-autocomplete",0),e.NdJ("setAddress",function(a){return i.getAddress(a)}),e.qZA(),e.TgZ(1,"google-map",1),e.NdJ("mapClick",function(a){return i.mapClicked(a)}),e.YNc(2,Y,2,4,"map-marker",2),e.YNc(3,w,1,4,"map-marker",2),e.qZA(),e.TgZ(4,"nz-card")(5,"nz-timeline",3),e.YNc(6,j,2,1,"nz-timeline-item",4),e.qZA()(),e.TgZ(7,"button",5),e.NdJ("click",function(){return i.removeLastPoint()}),e.TgZ(8,"span"),e._uU(9),e.ALo(10,"translate"),e.qZA()(),e.TgZ(11,"button",6),e.NdJ("click",function(){return i.goToServiceSelection()}),e.TgZ(12,"span"),e._uU(13),e.ALo(14,"translate"),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngForOf",i.drivers),e.xp6(1),e.Q6J("ngForOf",i.points),e.xp6(3),e.Q6J("ngForOf",i.points),e.xp6(3),e.Oqu(e.lcZ(10,6,"dispatcher.removeLastPoint")),e.xp6(2),e.Q6J("disabled",0===i.points.length),e.xp6(2),e.Oqu(e.lcZ(14,8,"profile.next")))},directives:[h,d.b6,C.sg,d.O_,b.bd,M.PD,M.Zv,F.ix,I.dQ,O.w],pipes:[v.X$],encapsulation:2}),n})();var x=l(4362),q=l(3905),J=l(3478);function G(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"nz-result",2)(1,"div",3)(2,"button",4),e.NdJ("click",function(){return e.CHM(t),e.oxw().cancelRequest()}),e._uU(3," Cancel Request "),e.qZA()()()}}function E(n,o){if(1&n&&(e.TgZ(0,"nz-result",7)(1,"div",3)(2,"button",8),e._uU(3," View Request Details "),e.qZA()()()),2&n){const t=e.oxw().ngIf;e.cQ8("nzTitle","",null==t.driver?null:t.driver.firstName," ",null==t.driver?null:t.driver.lastName," (",null==t.driver?null:t.driver.mobileNumber,") has accepted the request. Go to the trip page for more information."),e.xp6(2),e.Q6J("routerLink","/requests/view/"+t.id)}}function H(n,o){if(1&n&&(e.TgZ(0,"nz-result",9)(1,"div",3)(2,"button",8),e._uU(3," View Request Details "),e.qZA()()()),2&n){const t=e.oxw().ngIf;e.MGl("nzTitle","Trip status is updated to ",t.status,"."),e.xp6(2),e.Q6J("routerLink","/requests/view/"+t.id)}}function B(n,o){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,E,4,4,"nz-result",5),e.YNc(2,H,4,2,"nz-result",6),e.qZA()),2&n){const t=o.ngIf;e.xp6(1),e.Q6J("ngIf","DriverAccepted"==t.status),e.xp6(1),e.Q6J("ngIf","DriverAccepted"!=t.status)}}let X=(()=>{class n{constructor(t,i,r,a,g){this.orderUpdateSubscription=t,this.cancelOrderMutation=i,this.route=r,this.router=a,this.msg=g}ngOnInit(){this.query=this.orderUpdateSubscription.subscribe({id:this.route.snapshot.queryParams.requestId})}cancelRequest(){return(0,u.mG)(this,void 0,void 0,function*(){const t=this.route.snapshot.queryParams.requestId;yield(0,q.z)(this.cancelOrderMutation.mutate({orderId:t})),this.msg.success("Order Canceled."),this.router.navigate(["../riders-list"],{relativeTo:this.route})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(x.gj6),e.Y36(x.CAA),e.Y36(f.gz),e.Y36(f.F0),e.Y36(L.dD))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dispatcher-looking"]],decls:4,vars:6,consts:[["nzStatus","info","nzTitle","Looking For suitable driver. Please wait...",4,"ngIf"],[4,"ngIf"],["nzStatus","info","nzTitle","Looking For suitable driver. Please wait..."],["nz-result-extra",""],["nz-button","","nzType","default",3,"click"],["nzStatus","success",3,"nzTitle",4,"ngIf"],["nzStatus","info",3,"nzTitle",4,"ngIf"],["nzStatus","success",3,"nzTitle"],["nz-button","","nzType","default",3,"routerLink"],["nzStatus","info",3,"nzTitle"]],template:function(t,i){if(1&t&&(e.YNc(0,G,4,0,"nz-result",0),e.ALo(1,"async"),e.YNc(2,B,3,2,"div",1),e.ALo(3,"async")),2&t){let r,a;e.Q6J("ngIf",null==(null==(r=e.lcZ(1,2,i.query))||null==r.data?null:r.data.orderUpdated)),e.xp6(2),e.Q6J("ngIf",null==(a=e.lcZ(3,4,i.query))||null==a.data?null:a.data.orderUpdated)}},directives:[C.O5,J.ml,J.ey,F.ix,I.dQ,O.w,f.rH],pipes:[C.Ov],encapsulation:2}),n})();var k=l(4004),K=l(7633),Z=l(939),V=l(647),W=l(3677),ee=l(5390);function te(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"phone"),e.qZA(),e.TgZ(6,"td")(7,"a",18),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).selectRider(a.id)}),e._uU(8),e.qZA()()()}if(2&n){const t=o.$implicit;e.xp6(2),e.AsE("",t.firstName," ",t.lastName,""),e.xp6(2),e.Oqu(e.lcZ(5,4,t.mobileNumber)),e.xp6(4),e.Oqu("Select")}}function ne(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"nz-table",11,12),e.NdJ("nzQueryParams",function(r){return e.CHM(t),e.oxw().tableService.onTableQueryParamsChange(r)}),e.TgZ(2,"thead")(3,"tr")(4,"th",13),e._uU(5),e.ALo(6,"translate"),e.TgZ(7,"nz-filter-trigger",14),e.ALo(8,"async"),e._UZ(9,"i",15),e.qZA()(),e.TgZ(10,"th",16),e._uU(11),e.ALo(12,"translate"),e.TgZ(13,"nz-filter-trigger",14),e.ALo(14,"async"),e._UZ(15,"i",15),e.qZA()(),e._UZ(16,"th"),e.qZA()(),e.TgZ(17,"tbody"),e.YNc(18,te,9,6,"tr",17),e.qZA()()}if(2&n){const t=o.ngIf,i=e.MAs(1),r=e.oxw(),a=e.MAs(3),g=e.MAs(16);let S,P;e.Q6J("nzFrontPagination",!1)("nzData",t.nodes)("nzTotal",t.totalCount),e.xp6(4),e.Q6J("nzSortFn",!0),e.xp6(1),e.hij(" ",e.lcZ(6,12,"profile.name")," "),e.xp6(2),e.Q6J("nzActive",null==(S=e.lcZ(8,14,r.route.queryParams))||null==S.filter?null:S.filter.includes("lastName|like|"))("nzDropdownMenu",a),e.xp6(3),e.Q6J("nzSortFn",!0),e.xp6(1),e.hij(" ",e.lcZ(12,16,"profile.mobileNumber")," "),e.xp6(2),e.Q6J("nzActive",null==(P=e.lcZ(14,18,r.route.queryParams))||null==P.filter?null:P.filter.includes("mobileNumber|like|"))("nzDropdownMenu",g),e.xp6(5),e.Q6J("ngForOf",i.data)}}let ie=(()=>{class n{constructor(t,i,r,a){this.route=t,this.translate=i,this.tableService=r,this.router=a}ngOnInit(){this.query=this.route.data.pipe((0,k.U)(t=>t.riders))}selectRider(t){this.router.navigate(["../locations-select"],{relativeTo:this.route,queryParams:{riderId:t},queryParamsHandling:"merge"})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.gz),e.Y36(v.sK),e.Y36(K.w),e.Y36(f.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dispatcher-riders-list"]],decls:27,vars:18,consts:[["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["filtername","nzDropdownMenu"],[1,"ant-table-filter-dropdown"],[1,"search-box"],["nz-input","",3,"placeholder"],["lastNameInput",""],["nz-button","","nzSize","small","nzType","default",1,"search-button",3,"click"],["nz-button","","nzSize","small",3,"click"],["filtermobile","nzDropdownMenu"],["nz-input","","placeholder","Search Mobile Number"],["mobileNumberInput",""],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams"],["table",""],["nzCustomFilter","","nzColumnKey","lastName",3,"nzSortFn"],[3,"nzActive","nzDropdownMenu"],["nz-icon","","nzType","search"],["nzCustomFilter","","nzColumnKey","mobileNumber",3,"nzSortFn"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(t,i){if(1&t){const r=e.EpF();e.YNc(0,ne,19,20,"nz-table",0),e.ALo(1,"async"),e.TgZ(2,"nz-dropdown-menu",null,1)(4,"div",2)(5,"div",3),e._UZ(6,"input",4,5),e.ALo(8,"translate"),e.TgZ(9,"button",6),e.NdJ("click",function(){e.CHM(r);const g=e.MAs(7);return i.tableService.filterText("lastName",g.value)}),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"button",7),e.NdJ("click",function(){e.CHM(r);const g=e.MAs(7);return i.tableService.resetFilter("lastName",g)}),e._uU(13),e.ALo(14,"translate"),e.qZA()()()(),e.TgZ(15,"nz-dropdown-menu",null,8)(17,"div",2)(18,"div",3),e._UZ(19,"input",9,10),e.TgZ(21,"button",6),e.NdJ("click",function(){e.CHM(r);const g=e.MAs(20);return i.tableService.filterText("mobileNumber",g.value)}),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"button",7),e.NdJ("click",function(){e.CHM(r);const g=e.MAs(20);return i.tableService.resetFilter("mobileNumber",g)}),e._uU(25),e.ALo(26,"translate"),e.qZA()()()()}if(2&t){let r;e.Q6J("ngIf",null==(r=e.lcZ(1,6,i.query))||null==r.data?null:r.data.riders),e.xp6(6),e.s9C("placeholder",e.lcZ(8,8,"profile.lastName")),e.xp6(4),e.hij(" ",e.lcZ(11,10,"profile.search")," "),e.xp6(3),e.hij(" ",e.lcZ(14,12,"profile.reset")," "),e.xp6(9),e.hij(" ",e.lcZ(23,14,"profile.search")," "),e.xp6(3),e.hij(" ",e.lcZ(26,16,"profile.reset")," ")}},directives:[C.O5,Z.N8,Z.Om,Z.$Z,Z.Uo,Z._C,Z.qD,Z.Ql,O.w,V.Ls,Z.p0,C.sg,W.RR,T.Zp,F.ix,I.dQ],pipes:[C.Ov,v.X$,ee.E],encapsulation:2}),n})();var A=l(3762);function re(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"li",4)(1,"ul",5)(2,"nz-list-item-action")(3,"a",6),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).selectService(a)}),e._uU(4),e.ALo(5,"translate"),e.qZA()()(),e._uU(6),e.ALo(7,"currency"),e.qZA()}if(2&n){const t=o.$implicit,i=e.oxw(2).ngIf;e.xp6(4),e.Oqu(e.lcZ(5,3,"profile.select")),e.xp6(2),e.AsE(" ",t.name," (",e.xi3(7,5,t.cost,i.currency),") ")}}function oe(n,o){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,re,8,8,"li",3),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngForOf",t.services)}}function se(n,o){if(1&n&&(e.TgZ(0,"ul",1)(1,"nz-list-header"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,oe,2,1,"div",2),e.qZA()),2&n){const t=o.ngIf;e.Q6J("nzDataSource",t.services),e.xp6(2),e.Oqu(e.lcZ(3,3,"profile.services")),e.xp6(2),e.Q6J("ngForOf",t.services)}}let ae=(()=>{class n{constructor(t,i,r,a){this.route=t,this.router=i,this.dispatcherService=r,this.createOrderMutation=a}ngOnInit(){this.query=this.route.data.pipe((0,k.U)(t=>t.services))}selectService(t){var i;return(0,u.mG)(this,void 0,void 0,function*(){const r=this.route.snapshot.queryParams.riderId,a=this.dispatcherService.deserializePoints(this.route.snapshot.queryParams.points),g=yield(0,q.z)(this.createOrderMutation.mutate({riderId:r,points:a.map(S=>S.location),addresses:a.map(S=>S.address),serviceId:t.id}));this.router.navigate(["../looking"],{relativeTo:this.route,queryParams:{requestId:null===(i=g.data)||void 0===i?void 0:i.createOrder.id,points:void 0,riderId:void 0}})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.gz),e.Y36(f.F0),e.Y36(_),e.Y36(x.nr7))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dispatcher-service-select"]],decls:2,vars:3,consts:[["nz-list","","nzBordered","","nzSize","large",3,"nzDataSource",4,"ngIf"],["nz-list","","nzBordered","","nzSize","large",3,"nzDataSource"],[4,"ngFor","ngForOf"],["nz-list-item","","nzNoFlex","",4,"ngFor","ngForOf"],["nz-list-item","","nzNoFlex",""],["nz-list-item-actions",""],[3,"click"]],template:function(t,i){if(1&t&&(e.YNc(0,se,5,5,"ul",0),e.ALo(1,"async")),2&t){let r;e.Q6J("ngIf",null==(r=e.lcZ(1,1,i.query))||null==r.data?null:r.data.calculateFare)}},directives:[C.O5,A.n_,A.t4,C.sg,A.AA,A.nk,A.KC],pipes:[C.Ov,v.X$,C.H9],encapsulation:2}),n})(),U=(()=>{class n{constructor(t,i){this.dispatcherService=t,this.gql=i}resolve(t,i){const r=this.dispatcherService.deserializePoints(t.queryParams.points);return this.gql.fetch({points:r.map(a=>a.location)})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(_),e.LFG(x.Vqu))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();const le=[{path:"success/:id"},{path:"",component:c,children:[{path:"",redirectTo:"riders-list"},{path:"riders-list",component:ie,resolve:{riders:p.p}},{path:"locations-select",component:$},{path:"service-select",component:ae,resolve:{services:U}}]},{path:"looking",component:X}];let ce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[p.p,U],imports:[[f.Bz.forChild(le)],f.Bz]}),n})(),pe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[_],imports:[[C.ez,ce,D.m]]}),n})()}}]);