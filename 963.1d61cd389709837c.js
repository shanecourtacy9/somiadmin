"use strict";(self.webpackChunksomiadmin=self.webpackChunksomiadmin||[]).push([[963],{7633:(P,b,r)=>{r.d(b,{w:()=>L});var T=r(5e3),A=r(9826);let L=(()=>{class z{constructor(o,a){this.router=o,this.route=a}serializeQueryParams(o){const a={};if(a.pageIndex=(null==o?void 0:o.pageIndex)>1?o.pageIndex:void 0,10!=(null==o?void 0:o.pageSize)&&(a.pageSize=o.pageSize),null!=o.filter){const i=o.filter.filter(l=>null!=l.value&&l.value.length>0).map(l=>`${l.key}|${Array.isArray(l.value)?"in":"eq"}|${Array.isArray(l.value)?l.value.join("-"):l.value}`);a.filter=i.length>0?i.join(","):void 0}if(null!=o.sort&&o.sort.length>0){const i=o.sort.filter(l=>null!=l.value).map(l=>`${l.key}|${"ascend"==l.value?"ASC":"DESC"}`);a.sort=i.length>0?i.join(","):void 0}return a}onTableQueryParamsChange(o){const a=this.serializeQueryParams(o);this.router.navigate([],{relativeTo:this.route,queryParams:a,queryParamsHandling:"merge"})}filterText(o,a){var i;const u=null!==(i=this.deserializeQueryParams(this.route).filter)&&void 0!==i?i:{};u[o]=null!=a?{like:a}:{};const v=Object.keys(u).map(s=>{if(Object.keys(u[s]).length<1)return null;const c=Object.keys(u[s])[0];return`${s}|${c}|${"in"==c?u[s][c].join("-"):u[s][c]}`}).filter(s=>null!=s),p=v.length>0?v.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:p},queryParamsHandling:"merge"})}filterRange(o,a){var i;const u=null!==(i=this.deserializeQueryParams(this.route).filter)&&void 0!==i?i:{};u[o]=null!=a?{between:a}:{};const v=Object.keys(u).map(s=>{if(Object.keys(u[s]).length<1)return null;const c=Object.keys(u[s])[0];return`${s}|${c}|${"in"==c||"between"==c?u[s][c].join("-"):u[s][c]}`}).filter(s=>null!=s),p=v.length>0?v.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:p},queryParamsHandling:"merge"})}resetFilter(o,a){this.filterText(o,void 0),a.value=""}downloadURI(o,a){const i=document.createElement("a");i.download=a,i.href=o,i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)}deserializeQueryParams(o){var a;const i=o.sort?o.sort.split(",").map(p=>({field:p.split("|")[0],direction:p.split("|")[1]})):[],l={};null!=o.filter&&o.filter.split(",").forEach(p=>{const s={},c=p.split("|")[1];if("in"==c){const h=p.split("|")[2].split("-");s[c]=h}else if("between"==c){const h=p.split("|")[2].split("-");s[c]={lower:h[0],upper:h[1]}}else s[c]=p.split("|")[2];l[p.split("|")[0]]=s});const u=null!=o.pageIndex?parseInt(o.pageIndex):1,v=null!=o.pageSize?parseInt(o.pageSize):10;return{sorting:i.length>0?i:void 0,paging:{offset:null!==(a=(u-1)*v)&&void 0!==a?a:void 0,limit:v},filter:null!=l&&Object.keys(l).length>0?l:void 0}}}return z.\u0275fac=function(o){return new(o||z)(T.LFG(A.F0),T.LFG(A.gz))},z.\u0275prov=T.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},6220:(P,b,r)=>{r.r(b),r.d(b,{AnnouncementsModule:()=>M});var T=r(6889),A=r(9826),L=r(655),g=r(3075),y=r(4362),z=r(3905),n=r(5e3),o=r(9083),a=r(7484),i=r(4546),l=r(1894),u=r(1047),v=r(2905),p=r(6042),s=r(2643),c=r(2683),h=r(1062);let F=(()=>{class e{constructor(t,d,f,x,O){this.route=t,this.routerHelper=d,this.createGQL=f,this.updateGQL=x,this.fb=O,this.form=this.fb.group({id:[null],title:[null,g.kI.required],description:[null,g.kI.required],url:[null],dates:[null,g.kI.required]})}ngOnInit(){this.subscription=this.route.data.subscribe(t=>this.form.patchValue(t.announcement.data.announcement))}onSubmit(){return(0,L.mG)(this,void 0,void 0,function*(){const t=this.form.value,{id:d,dates:f}=t,x=(0,L._T)(t,["id","dates"]),O=f[0].getTime(),Y=f[1].getTime(),I=Object.assign(Object.assign({},x),{startAt:O,expireAt:Y});null==d?yield(0,z.z)(this.createGQL.mutate({input:I})):yield(0,z.z)(this.updateGQL.mutate({id:d,input:I})),this.routerHelper.goToParent(this.route)})}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(A.gz),n.Y36(o.b),n.Y36(y.MsJ),n.Y36(y.PHj),n.Y36(g.qu))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-announcement-view"]],decls:31,vars:11,consts:[["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[1,"lg:grid","lg:grid-cols-3","lg:gap-2"],["nzRequired","","nzFor","title"],["nz-input","","formControlName","title","id","title"],["nzRequired","","nzFor","description"],["nz-input","","formControlName","description","id","description"],["nzFor","url"],["nz-input","","formControlName","url","id","url"],["formControlName","dates",1,"w-full"],["nz-button","","nzType","default","type","submit",1,"float-right",3,"disabled"]],template:function(t,d){1&t&&(n.TgZ(0,"nz-card")(1,"h3"),n._uU(2),n.ALo(3,"translate"),n.qZA(),n._UZ(4,"br"),n.TgZ(5,"form",0),n.NdJ("ngSubmit",function(){return d.onSubmit()}),n.TgZ(6,"div",1)(7,"nz-form-item")(8,"nz-form-label",2),n._uU(9,"Title"),n.qZA(),n.TgZ(10,"nz-form-control"),n._UZ(11,"input",3),n.qZA()(),n.TgZ(12,"nz-form-item")(13,"nz-form-label",4),n._uU(14,"Description"),n.qZA(),n.TgZ(15,"nz-form-control"),n._UZ(16,"input",5),n.qZA()(),n.TgZ(17,"nz-form-item")(18,"nz-form-label",6),n._uU(19,"URL"),n.qZA(),n.TgZ(20,"nz-form-control"),n._UZ(21,"input",7),n.qZA()(),n.TgZ(22,"nz-form-item")(23,"nz-form-label"),n._uU(24),n.ALo(25,"translate"),n.qZA(),n.TgZ(26,"nz-form-control"),n._UZ(27,"nz-range-picker",8),n.qZA()()(),n.TgZ(28,"button",9),n._uU(29),n.ALo(30,"translate"),n.qZA()()()),2&t&&(n.xp6(2),n.Oqu(n.lcZ(3,5,"coupons.availabilityTime")),n.xp6(3),n.Q6J("formGroup",d.form),n.xp6(19),n.Oqu(n.lcZ(25,7,"coupons.availabilityTime")),n.xp6(4),n.Q6J("disabled",d.form.invalid),n.xp6(1),n.hij(" ",n.lcZ(30,9,"profile.submit")," "))},directives:[a.bd,g._Y,g.JL,i.Lr,g.sg,l.SK,i.Nx,l.t3,i.iK,i.Fd,u.Zp,g.Fj,g.JJ,g.u,v.uw,v.wS,p.ix,s.dQ,c.w],pipes:[h.X$],encapsulation:2}),e})(),U=(()=>{class e{constructor(t){this.gql=t}resolve(t,d){return this.gql.fetch({id:t.params.id})}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(y.w$I))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac}),e})();var D=r(4004),Q=r(7633),C=r(1945),q=r(647),S=r(9808),Z=r(939);function R(e,m){if(1&e&&(n.TgZ(0,"tr")(1,"td"),n._uU(2),n.qZA(),n.TgZ(3,"td"),n._uU(4),n.qZA(),n.TgZ(5,"td"),n._uU(6),n.ALo(7,"date"),n.ALo(8,"date"),n.qZA(),n.TgZ(9,"td")(10,"a",7),n._uU(11),n.ALo(12,"translate"),n.qZA()()()),2&e){const t=m.$implicit;n.xp6(2),n.Oqu(t.title),n.xp6(2),n.Oqu(t.description),n.xp6(2),n.AsE(" ",n.xi3(7,6,t.startAt,"mediumDate")," - ",n.xi3(8,9,t.expireAt,"mediumDate")," "),n.xp6(4),n.Q6J("routerLink","../view/"+t.id),n.xp6(1),n.Oqu(n.lcZ(12,12,"profile.view"))}}function w(e,m){if(1&e){const t=n.EpF();n.TgZ(0,"nz-table",4,5),n.NdJ("nzQueryParams",function(f){return n.CHM(t),n.oxw().tableService.onTableQueryParamsChange(f)}),n.TgZ(2,"thead")(3,"tr")(4,"th"),n._uU(5),n.ALo(6,"translate"),n.qZA(),n.TgZ(7,"th"),n._uU(8),n.ALo(9,"translate"),n.qZA(),n.TgZ(10,"th"),n._uU(11),n.ALo(12,"translate"),n.qZA(),n.TgZ(13,"th"),n._uU(14),n.ALo(15,"translate"),n.qZA()()(),n.TgZ(16,"tbody"),n.YNc(17,R,13,14,"tr",6),n.qZA()()}if(2&e){const t=m.ngIf,d=n.MAs(1);n.Q6J("nzFrontPagination",!1)("nzData",t.nodes)("nzTotal",t.totalCount),n.xp6(5),n.Oqu(n.lcZ(6,8,"profile.title")),n.xp6(3),n.Oqu(n.lcZ(9,10,"profile.description")),n.xp6(3),n.Oqu(n.lcZ(12,12,"profile.dateTime")),n.xp6(3),n.Oqu(n.lcZ(15,14,"profile.actions")),n.xp6(3),n.Q6J("ngForOf",d.data)}}let J=(()=>{class e{constructor(t,d){this.tableService=t,this.route=d}ngOnInit(){this.query=this.route.data.pipe((0,D.U)(t=>t.announcements))}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(Q.w),n.Y36(A.gz))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-announcement-list"]],decls:9,vars:7,consts:[["nzBackIcon","","nzTitle","Announcements","nzSubtitle","List of all the announcements",3,"nzGhost"],["nz-button","","nzType","default","routerLink","new"],["nz-icon","","nzType","plus"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams"],["table",""],[4,"ngFor","ngForOf"],[3,"routerLink"]],template:function(t,d){if(1&t&&(n.TgZ(0,"nz-page-header",0)(1,"nz-page-header-extra")(2,"button",1),n._UZ(3,"i",2),n._uU(4),n.ALo(5,"translate"),n.qZA()(),n.TgZ(6,"nz-page-header-content"),n.YNc(7,w,18,16,"nz-table",3),n.ALo(8,"async"),n.qZA()()),2&t){let f;n.Q6J("nzGhost",!1),n.xp6(4),n.hij("",n.lcZ(5,3,"profile.add")," "),n.xp6(3),n.Q6J("ngIf",null==(f=n.lcZ(8,5,d.query))||null==f.data?null:f.data.announcements)}},directives:[C.$O,C.Jp,p.ix,s.dQ,c.w,A.rH,q.Ls,C.u5,S.O5,Z.N8,Z.Om,Z.$Z,Z.Uo,Z._C,Z.p0,S.sg,A.yS],pipes:[h.X$,S.Ov,S.uU],encapsulation:2}),e})(),j=(()=>{class e{constructor(t,d){this.paging=t,this.gql=d}resolve(t,d){const f=this.paging.deserializeQueryParams(t.queryParams);return this.gql.fetch(f)}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(Q.w),n.LFG(y.R9J))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac}),e})();const $=[{path:"",component:J,resolve:{announcements:j},runGuardsAndResolvers:"paramsOrQueryParamsChange"},{path:"view/:id",component:F,resolve:{announcement:U}},{path:"new",component:F}];let G=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({providers:[j,U],imports:[[A.Bz.forChild($)],A.Bz]}),e})(),M=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[G,T.m]]}),e})()}}]);