"use strict";(self.webpackChunksomiadmin=self.webpackChunksomiadmin||[]).push([[121],{7633:(b,Z,o)=>{o.d(Z,{w:()=>R});var v=o(5e3),y=o(9826);let R=(()=>{class z{constructor(e,l){this.router=e,this.route=l}serializeQueryParams(e){const l={};if(l.pageIndex=(null==e?void 0:e.pageIndex)>1?e.pageIndex:void 0,10!=(null==e?void 0:e.pageSize)&&(l.pageSize=e.pageSize),null!=e.filter){const i=e.filter.filter(a=>null!=a.value&&a.value.length>0).map(a=>`${a.key}|${Array.isArray(a.value)?"in":"eq"}|${Array.isArray(a.value)?a.value.join("-"):a.value}`);l.filter=i.length>0?i.join(","):void 0}if(null!=e.sort&&e.sort.length>0){const i=e.sort.filter(a=>null!=a.value).map(a=>`${a.key}|${"ascend"==a.value?"ASC":"DESC"}`);l.sort=i.length>0?i.join(","):void 0}return l}onTableQueryParamsChange(e){const l=this.serializeQueryParams(e);this.router.navigate([],{relativeTo:this.route,queryParams:l,queryParamsHandling:"merge"})}filterText(e,l){var i;const u=null!==(i=this.deserializeQueryParams(this.route).filter)&&void 0!==i?i:{};u[e]=null!=l?{like:l}:{};const h=Object.keys(u).map(s=>{if(Object.keys(u[s]).length<1)return null;const d=Object.keys(u[s])[0];return`${s}|${d}|${"in"==d?u[s][d].join("-"):u[s][d]}`}).filter(s=>null!=s),g=h.length>0?h.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:g},queryParamsHandling:"merge"})}filterRange(e,l){var i;const u=null!==(i=this.deserializeQueryParams(this.route).filter)&&void 0!==i?i:{};u[e]=null!=l?{between:l}:{};const h=Object.keys(u).map(s=>{if(Object.keys(u[s]).length<1)return null;const d=Object.keys(u[s])[0];return`${s}|${d}|${"in"==d||"between"==d?u[s][d].join("-"):u[s][d]}`}).filter(s=>null!=s),g=h.length>0?h.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:g},queryParamsHandling:"merge"})}resetFilter(e,l){this.filterText(e,void 0),l.value=""}downloadURI(e,l){const i=document.createElement("a");i.download=l,i.href=e,i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)}deserializeQueryParams(e){var l;const i=e.sort?e.sort.split(",").map(g=>({field:g.split("|")[0],direction:g.split("|")[1]})):[],a={};null!=e.filter&&e.filter.split(",").forEach(g=>{const s={},d=g.split("|")[1];if("in"==d){const c=g.split("|")[2].split("-");s[d]=c}else if("between"==d){const c=g.split("|")[2].split("-");s[d]={lower:c[0],upper:c[1]}}else s[d]=g.split("|")[2];a[g.split("|")[0]]=s});const u=null!=e.pageIndex?parseInt(e.pageIndex):1,h=null!=e.pageSize?parseInt(e.pageSize):10;return{sorting:i.length>0?i:void 0,paging:{offset:null!==(l=(u-1)*h)&&void 0!==l?l:void 0,limit:h},filter:null!=a&&Object.keys(a).length>0?a:void 0}}}return z.\u0275fac=function(e){return new(e||z)(v.LFG(y.F0),v.LFG(y.gz))},z.\u0275prov=v.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},8121:(b,Z,o)=>{o.r(Z),o.d(Z,{RiderWalletsModule:()=>J});var v=o(9808),y=o(9826),R=o(655),T=o(4362),x=o(2340),z=o(4004),_=o(3905),e=o(5e3),l=o(7633),i=o(1945),a=o(6042),u=o(2643),h=o(2683),g=o(3677),s=o(647),d=o(4219),c=o(939),L=o(1047),A=o(3075),M=o(1062);function F(t,f){if(1&t&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td")(9,"a",22),e._uU(10),e.ALo(11,"translate"),e.qZA()()()),2&t){const n=f.$implicit;e.xp6(2),e.AsE("",n.rider.firstName," ",n.rider.lastName,""),e.xp6(2),e.Oqu(e.xi3(5,6,n.balance,n.currency)),e.xp6(3),e.Oqu(n.currency),e.xp6(2),e.Q6J("routerLink","/riders/view/"+n.riderId),e.xp6(1),e.Oqu(e.lcZ(11,9,"table.viewRider"))}}const W=function(){return[]};function O(t,f){if(1&t){const n=e.EpF();e.TgZ(0,"nz-table",15,16),e.NdJ("nzQueryParams",function(p){return e.CHM(n),e.oxw(2).tableService.onTableQueryParamsChange(p)}),e.TgZ(2,"thead")(3,"tr")(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th",17),e._uU(8),e.ALo(9,"translate"),e.TgZ(10,"nz-filter-trigger",18),e._UZ(11,"i",19),e.qZA()(),e.TgZ(12,"th",20),e.ALo(13,"async"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA()()(),e.TgZ(19,"tbody"),e.YNc(20,F,12,11,"tr",21),e.qZA()()}if(2&t){const n=f.ngIf,r=e.MAs(1),p=e.oxw(2),m=e.MAs(15);let C;e.Q6J("nzFrontPagination",!1)("nzData",n.nodes)("nzTotal",n.totalCount),e.xp6(5),e.Oqu(e.lcZ(6,12,"profile.name")),e.xp6(3),e.hij(" ",e.lcZ(9,14,"profile.amount")," "),e.xp6(2),e.Q6J("nzActive",-1!==p.amountRange[0])("nzDropdownMenu",m),e.xp6(2),e.Q6J("nzFilters",null!==(C=e.lcZ(13,16,p.currencies))&&void 0!==C?C:e.DdM(22,W))("nzFilterFn",!0),e.xp6(2),e.hij(" ",e.lcZ(15,18,"profile.currency")," "),e.xp6(3),e.Oqu(e.lcZ(18,20,"profile.actions")),e.xp6(3),e.Q6J("ngForOf",r.data)}}function D(t,f){if(1&t&&(e.TgZ(0,"nz-page-header-content"),e.YNc(1,O,21,23,"nz-table",14),e.ALo(2,"async"),e.qZA()),2&t){const n=e.oxw();let r;e.xp6(1),e.Q6J("ngIf",null==(r=e.lcZ(2,1,n.query))||null==r.data?null:r.data.riderWallets)}}let Q=(()=>{class t{constructor(n,r,p){this.route=n,this.tableService=r,this.exportGql=p,this.amountRange=[-1,-1]}ngOnInit(){this.query=this.route.data.pipe((0,z.U)(n=>n.riderWallet)),this.currencies=this.query.pipe((0,z.U)(n=>this.distinctCurrency(n.data.regions.nodes).map(r=>({text:r,value:r}))))}exportTo(n){return(0,R.mG)(this,void 0,void 0,function*(){const r=yield(0,_.z)(this.exportGql.fetch({input:{table:T._bY.RiderWallet,type:T.tM1.Csv,relations:["rider"]}}));this.tableService.downloadURI(x.N.root+r.data.export.url,`export-${(new Date).getTime()}.csv`)})}distinctCurrency(n){return n.map(r=>r.currency).filter((r,p,m)=>m.indexOf(r)===p)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(y.gz),e.Y36(l.w),e.Y36(T.gqb))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-rider-wallets"]],decls:28,vars:22,consts:[["nzBackIcon","","nzTitle","Rider Wallets","nzSubtitle","List of riders current wallet balance",3,"nzGhost"],["nz-button","","nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","export"],["nz-icon","","nzType","down"],["menuExport","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],[4,"ngIf"],["filteramount","nzDropdownMenu"],[1,"ant-table-filter-dropdown"],[1,"search-box"],["nz-input","","type","number",3,"placeholder","ngModel","ngModelChange"],["nz-button","","nzSize","small","nzType","default",1,"search-button",3,"click"],["nz-button","","nzSize","small",3,"click"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams"],["table",""],["nzShowSort","","nzColumnKey","amount","nzCustomFilter",""],[3,"nzActive","nzDropdownMenu"],["nz-icon","","nzType","search"],["nzShowSort","","nzColumnKey","currency","nzShowFilter","",3,"nzFilters","nzFilterFn"],[4,"ngFor","ngForOf"],[3,"routerLink"]],template:function(n,r){if(1&n&&(e.TgZ(0,"nz-page-header",0)(1,"nz-page-header-extra")(2,"button",1),e._UZ(3,"i",2),e._uU(4),e.ALo(5,"translate"),e._UZ(6,"i",3),e.qZA(),e.TgZ(7,"nz-dropdown-menu",null,4)(9,"ul",5)(10,"li",6),e.NdJ("click",function(){return r.exportTo("csv")}),e._uU(11,"CSV"),e.qZA()()()(),e.YNc(12,D,3,3,"nz-page-header-content",7),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"nz-dropdown-menu",null,8)(16,"div",9)(17,"div",10)(18,"input",11),e.NdJ("ngModelChange",function(m){return r.amountRange[0]=m}),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"input",11),e.NdJ("ngModelChange",function(m){return r.amountRange[1]=m}),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"button",12),e.NdJ("click",function(){return r.tableService.filterRange("balance",r.amountRange)}),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"button",13),e.NdJ("click",function(){return r.tableService.filterRange("balance",void 0)}),e._uU(26),e.ALo(27,"translate"),e.qZA()()()()),2&n){const p=e.MAs(8);let m;e.Q6J("nzGhost",!1),e.xp6(2),e.Q6J("nzDropdownMenu",p),e.xp6(2),e.hij(" ",e.lcZ(5,10,"profile.export")," "),e.xp6(8),e.Q6J("ngIf",null==(m=e.lcZ(13,12,r.query))?null:m.data),e.xp6(6),e.s9C("placeholder",e.lcZ(19,14,"table.min")),e.Q6J("ngModel",r.amountRange[0]),e.xp6(2),e.s9C("placeholder",e.lcZ(21,16,"table.max")),e.Q6J("ngModel",r.amountRange[1]),e.xp6(3),e.hij(" ",e.lcZ(24,18,"profile.search")," "),e.xp6(3),e.hij(" ",e.lcZ(27,20,"profile.reset")," ")}},directives:[i.$O,i.Jp,a.ix,u.dQ,h.w,g.wA,g.cm,s.Ls,g.RR,d.wO,d.r9,v.O5,i.u5,c.N8,c.Om,c.$Z,c.Uo,c._C,c.qD,c.Ql,c.p0,v.sg,y.yS,L.Zp,A.wV,A.Fj,A.JJ,A.On],pipes:[M.X$,v.Ov,v.H9],encapsulation:2}),t})(),S=(()=>{class t{constructor(n,r){this.paging=n,this.gql=r}resolve(n,r){const p=this.paging.deserializeQueryParams(n.queryParams);return this.gql.fetch(p)}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(l.w),e.LFG(T.vYB))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();const w=[{path:"",component:Q,resolve:{riderWallet:S},runGuardsAndResolvers:"paramsOrQueryParamsChange"}];let j=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[S],imports:[[y.Bz.forChild(w)],y.Bz]}),t})();var I=o(6889);let J=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[v.ez,j,I.m]]}),t})()}}]);