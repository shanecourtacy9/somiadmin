"use strict";(self.webpackChunksomiadmin=self.webpackChunksomiadmin||[]).push([[984],{7633:(L,A,o)=>{o.d(A,{w:()=>_});var T=o(5e3),y=o(9826);let _=(()=>{class f{constructor(e,l){this.router=e,this.route=l}serializeQueryParams(e){const l={};if(l.pageIndex=(null==e?void 0:e.pageIndex)>1?e.pageIndex:void 0,10!=(null==e?void 0:e.pageSize)&&(l.pageSize=e.pageSize),null!=e.filter){const i=e.filter.filter(a=>null!=a.value&&a.value.length>0).map(a=>`${a.key}|${Array.isArray(a.value)?"in":"eq"}|${Array.isArray(a.value)?a.value.join("-"):a.value}`);l.filter=i.length>0?i.join(","):void 0}if(null!=e.sort&&e.sort.length>0){const i=e.sort.filter(a=>null!=a.value).map(a=>`${a.key}|${"ascend"==a.value?"ASC":"DESC"}`);l.sort=i.length>0?i.join(","):void 0}return l}onTableQueryParamsChange(e){const l=this.serializeQueryParams(e);this.router.navigate([],{relativeTo:this.route,queryParams:l,queryParamsHandling:"merge"})}filterText(e,l){var i;const u=null!==(i=this.deserializeQueryParams(this.route).filter)&&void 0!==i?i:{};u[e]=null!=l?{like:l}:{};const m=Object.keys(u).map(s=>{if(Object.keys(u[s]).length<1)return null;const c=Object.keys(u[s])[0];return`${s}|${c}|${"in"==c?u[s][c].join("-"):u[s][c]}`}).filter(s=>null!=s),p=m.length>0?m.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:p},queryParamsHandling:"merge"})}filterRange(e,l){var i;const u=null!==(i=this.deserializeQueryParams(this.route).filter)&&void 0!==i?i:{};u[e]=null!=l?{between:l}:{};const m=Object.keys(u).map(s=>{if(Object.keys(u[s]).length<1)return null;const c=Object.keys(u[s])[0];return`${s}|${c}|${"in"==c||"between"==c?u[s][c].join("-"):u[s][c]}`}).filter(s=>null!=s),p=m.length>0?m.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:p},queryParamsHandling:"merge"})}resetFilter(e,l){this.filterText(e,void 0),l.value=""}downloadURI(e,l){const i=document.createElement("a");i.download=l,i.href=e,i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)}deserializeQueryParams(e){var l;const i=e.sort?e.sort.split(",").map(p=>({field:p.split("|")[0],direction:p.split("|")[1]})):[],a={};null!=e.filter&&e.filter.split(",").forEach(p=>{const s={},c=p.split("|")[1];if("in"==c){const g=p.split("|")[2].split("-");s[c]=g}else if("between"==c){const g=p.split("|")[2].split("-");s[c]={lower:g[0],upper:g[1]}}else s[c]=p.split("|")[2];a[p.split("|")[0]]=s});const u=null!=e.pageIndex?parseInt(e.pageIndex):1,m=null!=e.pageSize?parseInt(e.pageSize):10;return{sorting:i.length>0?i:void 0,paging:{offset:null!==(l=(u-1)*m)&&void 0!==l?l:void 0,limit:m},filter:null!=a&&Object.keys(a).length>0?a:void 0}}}return f.\u0275fac=function(e){return new(e||f)(T.LFG(y.F0),T.LFG(y.gz))},f.\u0275prov=T.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},1984:(L,A,o)=>{o.r(A),o.d(A,{DriverWalletsModule:()=>J});var T=o(6889),y=o(9826),_=o(655),Z=o(4362),S=o(2340),f=o(4004),C=o(3905),e=o(5e3),l=o(7633),i=o(1945),a=o(6042),u=o(2643),m=o(2683),p=o(3677),s=o(647),c=o(4219),g=o(9808),h=o(939),M=o(1047),D=o(3075),F=o(1062);function W(t,v){if(1&t&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td")(9,"a",22),e._uU(10),e.ALo(11,"translate"),e.qZA()()()),2&t){const n=v.$implicit;e.xp6(2),e.AsE("",n.driver.firstName," ",n.driver.lastName,""),e.xp6(2),e.Oqu(e.xi3(5,6,n.balance,n.currency)),e.xp6(3),e.Oqu(n.currency),e.xp6(2),e.Q6J("routerLink","/drivers/view/"+n.driverId),e.xp6(1),e.Oqu(e.lcZ(11,9,"table.viewDriver"))}}const O=function(){return[]};function Q(t,v){if(1&t){const n=e.EpF();e.TgZ(0,"nz-table",15,16),e.NdJ("nzQueryParams",function(d){return e.CHM(n),e.oxw(2).tableService.onTableQueryParamsChange(d)}),e.TgZ(2,"thead")(3,"tr")(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th",17),e._uU(8),e.ALo(9,"translate"),e.TgZ(10,"nz-filter-trigger",18),e._UZ(11,"i",19),e.qZA()(),e.TgZ(12,"th",20),e.ALo(13,"async"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA()()(),e.TgZ(19,"tbody"),e.YNc(20,W,12,11,"tr",21),e.qZA()()}if(2&t){const n=v.ngIf,r=e.MAs(1),d=e.oxw(2),z=e.MAs(15);let x;e.Q6J("nzFrontPagination",!1)("nzData",n.nodes)("nzTotal",n.totalCount),e.xp6(5),e.Oqu(e.lcZ(6,12,"profile.name")),e.xp6(3),e.hij(" ",e.lcZ(9,14,"profile.amount")," "),e.xp6(2),e.Q6J("nzActive",-1!==d.amountRange[0])("nzDropdownMenu",z),e.xp6(2),e.Q6J("nzFilters",null!==(x=e.lcZ(13,16,d.currencies))&&void 0!==x?x:e.DdM(22,O))("nzFilterFn",!0),e.xp6(2),e.hij(" ",e.lcZ(15,18,"profile.currency")," "),e.xp6(3),e.Oqu(e.lcZ(18,20,"profile.actions")),e.xp6(3),e.Q6J("ngForOf",r.data)}}function w(t,v){if(1&t&&(e.TgZ(0,"nz-page-header-content"),e.YNc(1,Q,21,23,"nz-table",14),e.ALo(2,"async"),e.qZA()),2&t){const n=e.oxw();let r;e.xp6(1),e.Q6J("ngIf",null==(r=e.lcZ(2,1,n.query))||null==r.data?null:r.data.driverWallets)}}let R=(()=>{class t{constructor(n,r,d){this.route=n,this.exportGql=r,this.tableService=d,this.amountRange=[-1,-1]}ngOnInit(){this.query=this.route.data.pipe((0,f.U)(n=>n.driverWallet)),this.currencies=this.query.pipe((0,f.U)(n=>this.distinctCurrency(n.data.regions.nodes).map(r=>({text:r,value:r}))))}exportTo(n){return(0,_.mG)(this,void 0,void 0,function*(){const r=yield(0,C.z)(this.exportGql.fetch({input:{table:Z._bY.DriverWallet,type:Z.tM1.Csv,relations:["driver"]}}));this.tableService.downloadURI(S.N.root+r.data.export.url,`export-${(new Date).getTime()}.csv`)})}distinctCurrency(n){return n.map(r=>r.currency).filter((r,d,z)=>z.indexOf(r)===d)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(y.gz),e.Y36(Z.gqb),e.Y36(l.w))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-driver-wallets-list"]],decls:28,vars:22,consts:[["nzBackIcon","","nzTitle","Driver Wallets","nzSubtitle","List of drivers current wallet balance",3,"nzGhost"],["nz-button","","nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","export"],["nz-icon","","nzType","down"],["menuExport","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],[4,"ngIf"],["filteramount","nzDropdownMenu"],[1,"ant-table-filter-dropdown"],[1,"search-box"],["nz-input","","type","number",3,"placeholder","ngModel","ngModelChange"],["nz-button","","nzSize","small","nzType","default",1,"search-button",3,"click"],["nz-button","","nzSize","small",3,"click"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams"],["table",""],["nzShowSort","","nzColumnKey","amount","nzCustomFilter",""],[3,"nzActive","nzDropdownMenu"],["nz-icon","","nzType","search"],["nzShowSort","","nzColumnKey","currency","nzShowFilter","",3,"nzFilters","nzFilterFn"],[4,"ngFor","ngForOf"],[3,"routerLink"]],template:function(n,r){if(1&n&&(e.TgZ(0,"nz-page-header",0)(1,"nz-page-header-extra")(2,"button",1),e._UZ(3,"i",2),e._uU(4),e.ALo(5,"translate"),e._UZ(6,"i",3),e.qZA(),e.TgZ(7,"nz-dropdown-menu",null,4)(9,"ul",5)(10,"li",6),e.NdJ("click",function(){return r.exportTo("csv")}),e._uU(11,"CSV"),e.qZA()()()(),e.YNc(12,w,3,3,"nz-page-header-content",7),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"nz-dropdown-menu",null,8)(16,"div",9)(17,"div",10)(18,"input",11),e.NdJ("ngModelChange",function(z){return r.amountRange[0]=z}),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"input",11),e.NdJ("ngModelChange",function(z){return r.amountRange[1]=z}),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"button",12),e.NdJ("click",function(){return r.tableService.filterRange("balance",r.amountRange)}),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"button",13),e.NdJ("click",function(){return r.tableService.filterRange("balance",void 0)}),e._uU(26),e.ALo(27,"translate"),e.qZA()()()()),2&n){const d=e.MAs(8);let z;e.Q6J("nzGhost",!1),e.xp6(2),e.Q6J("nzDropdownMenu",d),e.xp6(2),e.hij(" ",e.lcZ(5,10,"profile.export")," "),e.xp6(8),e.Q6J("ngIf",null==(z=e.lcZ(13,12,r.query))?null:z.data),e.xp6(6),e.s9C("placeholder",e.lcZ(19,14,"table.min")),e.Q6J("ngModel",r.amountRange[0]),e.xp6(2),e.s9C("placeholder",e.lcZ(21,16,"table.max")),e.Q6J("ngModel",r.amountRange[1]),e.xp6(3),e.hij(" ",e.lcZ(24,18,"profile.search")," "),e.xp6(3),e.hij(" ",e.lcZ(27,20,"profile.reset")," ")}},directives:[i.$O,i.Jp,a.ix,u.dQ,m.w,p.wA,p.cm,s.Ls,p.RR,c.wO,c.r9,g.O5,i.u5,h.N8,h.Om,h.$Z,h.Uo,h._C,h.qD,h.Ql,h.p0,g.sg,y.yS,M.Zp,D.wV,D.Fj,D.JJ,D.On],pipes:[F.X$,g.Ov,g.H9],encapsulation:2}),t})(),b=(()=>{class t{constructor(n,r){this.paging=n,this.gql=r}resolve(n,r){const d=this.paging.deserializeQueryParams(n.queryParams);return this.gql.fetch(d)}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(l.w),e.LFG(Z.lIR))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();const j=[{path:"",component:R,resolve:{driverWallet:b},runGuardsAndResolvers:"paramsOrQueryParamsChange"}];let I=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[b],imports:[[y.Bz.forChild(j)],y.Bz]}),t})(),J=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[I,T.m]]}),t})()}}]);