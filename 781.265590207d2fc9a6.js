"use strict";(self.webpackChunksomiadmin=self.webpackChunksomiadmin||[]).push([[781],{7633:(_,A,r)=>{r.d(A,{w:()=>q});var v=r(5e3),C=r(9826);let q=(()=>{class g{constructor(o,i){this.router=o,this.route=i}serializeQueryParams(o){const i={};if(i.pageIndex=(null==o?void 0:o.pageIndex)>1?o.pageIndex:void 0,10!=(null==o?void 0:o.pageSize)&&(i.pageSize=o.pageSize),null!=o.filter){const l=o.filter.filter(s=>null!=s.value&&s.value.length>0).map(s=>`${s.key}|${Array.isArray(s.value)?"in":"eq"}|${Array.isArray(s.value)?s.value.join("-"):s.value}`);i.filter=l.length>0?l.join(","):void 0}if(null!=o.sort&&o.sort.length>0){const l=o.sort.filter(s=>null!=s.value).map(s=>`${s.key}|${"ascend"==s.value?"ASC":"DESC"}`);i.sort=l.length>0?l.join(","):void 0}return i}onTableQueryParamsChange(o){const i=this.serializeQueryParams(o);this.router.navigate([],{relativeTo:this.route,queryParams:i,queryParamsHandling:"merge"})}filterText(o,i){var l;const a=null!==(l=this.deserializeQueryParams(this.route).filter)&&void 0!==l?l:{};a[o]=null!=i?{like:i}:{};const Z=Object.keys(a).map(u=>{if(Object.keys(a[u]).length<1)return null;const m=Object.keys(a[u])[0];return`${u}|${m}|${"in"==m?a[u][m].join("-"):a[u][m]}`}).filter(u=>null!=u),f=Z.length>0?Z.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:f},queryParamsHandling:"merge"})}filterRange(o,i){var l;const a=null!==(l=this.deserializeQueryParams(this.route).filter)&&void 0!==l?l:{};a[o]=null!=i?{between:i}:{};const Z=Object.keys(a).map(u=>{if(Object.keys(a[u]).length<1)return null;const m=Object.keys(a[u])[0];return`${u}|${m}|${"in"==m||"between"==m?a[u][m].join("-"):a[u][m]}`}).filter(u=>null!=u),f=Z.length>0?Z.join(","):void 0;this.router.navigate([],{relativeTo:this.route,queryParams:{filter:f},queryParamsHandling:"merge"})}resetFilter(o,i){this.filterText(o,void 0),i.value=""}downloadURI(o,i){const l=document.createElement("a");l.download=i,l.href=o,l.target="_blank",document.body.appendChild(l),l.click(),document.body.removeChild(l)}deserializeQueryParams(o){var i;const l=o.sort?o.sort.split(",").map(f=>({field:f.split("|")[0],direction:f.split("|")[1]})):[],s={};null!=o.filter&&o.filter.split(",").forEach(f=>{const u={},m=f.split("|")[1];if("in"==m){const h=f.split("|")[2].split("-");u[m]=h}else if("between"==m){const h=f.split("|")[2].split("-");u[m]={lower:h[0],upper:h[1]}}else u[m]=f.split("|")[2];s[f.split("|")[0]]=u});const a=null!=o.pageIndex?parseInt(o.pageIndex):1,Z=null!=o.pageSize?parseInt(o.pageSize):10;return{sorting:l.length>0?l:void 0,paging:{offset:null!==(i=(a-1)*Z)&&void 0!==i?i:void 0,limit:Z},filter:null!=s&&Object.keys(s).length>0?s:void 0}}}return g.\u0275fac=function(o){return new(o||g)(v.LFG(C.F0),v.LFG(C.gz))},g.\u0275prov=v.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},3781:(_,A,r)=>{r.r(A),r.d(A,{CouponsModule:()=>B});var v=r(9808),C=r(9826),q=r(5233),L=r(4004),n=r(5e3),g=r(7633),T=r(1945),o=r(6042),i=r(2643),l=r(2683),s=r(647),a=r(939),Z=r(8481),f=r(1062);function u(e,p){if(1&e&&(n.TgZ(0,"tr")(1,"td"),n._uU(2),n.qZA(),n.TgZ(3,"td",6),n._uU(4),n.qZA(),n.TgZ(5,"td"),n._uU(6),n.qZA(),n.TgZ(7,"td"),n._uU(8),n.ALo(9,"date"),n.ALo(10,"date"),n.qZA(),n.TgZ(11,"td",6)(12,"nz-tag",9),n._uU(13),n.ALo(14,"translate"),n.ALo(15,"translate"),n.qZA()(),n.TgZ(16,"td")(17,"a",10),n._uU(18),n.ALo(19,"translate"),n.qZA()()()),2&e){const t=p.$implicit,d=n.oxw(2);n.xp6(2),n.Oqu(t.title),n.xp6(2),n.Oqu(t.description),n.xp6(2),n.Oqu(t.code),n.xp6(2),n.AsE(" ",n.xi3(9,9,t.startAt,"mediumDate")," - ",n.xi3(10,12,t.expireAt,"mediumDate")," "),n.xp6(4),n.Q6J("nzColor",d.tagColor.boolean(t.isEnabled)),n.xp6(1),n.Oqu(t.isEnabled?n.lcZ(14,15,"profile.enabled"):n.lcZ(15,17,"profile.disabled")),n.xp6(4),n.Q6J("routerLink","../view/"+t.id),n.xp6(1),n.Oqu(n.lcZ(19,19,"profile.view"))}}function m(e,p){if(1&e){const t=n.EpF();n.TgZ(0,"nz-table",4,5),n.NdJ("nzQueryParams",function(z){return n.CHM(t),n.oxw().tableService.onTableQueryParamsChange(z)}),n.TgZ(2,"thead")(3,"tr")(4,"th"),n._uU(5),n.ALo(6,"translate"),n.qZA(),n.TgZ(7,"th",6),n._uU(8),n.ALo(9,"translate"),n.qZA(),n.TgZ(10,"th"),n._uU(11),n.ALo(12,"translate"),n.qZA(),n.TgZ(13,"th"),n._uU(14),n.ALo(15,"translate"),n.qZA(),n.TgZ(16,"th",7),n._uU(17),n.ALo(18,"translate"),n.qZA(),n.TgZ(19,"th"),n._uU(20),n.ALo(21,"translate"),n.qZA()()(),n.TgZ(22,"tbody"),n.YNc(23,u,20,21,"tr",8),n.qZA()()}if(2&e){const t=p.ngIf,d=n.MAs(1);n.Q6J("nzFrontPagination",!1)("nzData",t.nodes)("nzTotal",t.totalCount),n.xp6(5),n.Oqu(n.lcZ(6,10,"profile.title")),n.xp6(3),n.hij(" ",n.lcZ(9,12,"profile.description")," "),n.xp6(3),n.Oqu(n.lcZ(12,14,"profile.code")),n.xp6(3),n.Oqu(n.lcZ(15,16,"profile.dateTime")),n.xp6(3),n.hij(" ",n.lcZ(18,18,"profile.status")," "),n.xp6(3),n.Oqu(n.lcZ(21,20,"profile.actions")),n.xp6(3),n.Q6J("ngForOf",d.data)}}let h=(()=>{class e{constructor(t,d,z){this.route=t,this.tableService=d,this.tagColor=z}ngOnInit(){this.query=this.route.data.pipe((0,L.U)(t=>t.coupons))}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(C.gz),n.Y36(g.w),n.Y36(q.k))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-coupons-list"]],decls:9,vars:7,consts:[["nzBackIcon","","nzTitle","Coupons","nzSubtitle","List of all the coupons",3,"nzGhost"],["nz-button","","nzType","default","routerLink","new"],["nz-icon","","nzType","plus"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams",4,"ngIf"],["nzShowSizeChanger","","nzBordered","",3,"nzFrontPagination","nzData","nzTotal","nzQueryParams"],["table",""],[1,"hidden","lg:table-cell"],["nzShowSort","","nzColumnKey","isEnabled",1,"hidden","lg:table-cell"],[4,"ngFor","ngForOf"],[3,"nzColor"],[3,"routerLink"]],template:function(t,d){if(1&t&&(n.TgZ(0,"nz-page-header",0)(1,"nz-page-header-extra")(2,"button",1),n._UZ(3,"i",2),n._uU(4),n.ALo(5,"translate"),n.qZA()(),n.TgZ(6,"nz-page-header-content"),n.YNc(7,m,24,22,"nz-table",3),n.ALo(8,"async"),n.qZA()()),2&t){let z;n.Q6J("nzGhost",!1),n.xp6(4),n.hij("",n.lcZ(5,3,"profile.add")," "),n.xp6(3),n.Q6J("ngIf",null==(z=n.lcZ(8,5,d.query))||null==z.data?null:z.data.coupons)}},directives:[T.$O,T.Jp,o.ix,i.dQ,l.w,C.rH,s.Ls,T.u5,v.O5,a.N8,a.Om,a.$Z,a.Uo,a._C,a.qD,a.p0,v.sg,Z.j,C.yS],pipes:[f.X$,v.Ov,v.uU],encapsulation:2}),e})();var S=r(655),c=r(3075),U=r(4362),O=r(3905),G=r(9727),E=r(9083),N=r(7484),b=r(4546),I=r(1894),$=r(1047),w=r(656),Q=r(2905),J=r(6462);let P=(()=>{class e{constructor(t,d,z,y,F,x){this.route=t,this.message=d,this.fb=z,this.routerHelper=y,this.createGQL=F,this.updateGQL=x,this.form=this.fb.group({id:[null],code:[null,c.kI.required],title:[null,c.kI.required],description:[null,c.kI.required],manyUsersCanUse:[0,c.kI.required],manyTimesUserCanUse:[0,c.kI.required],minimumCost:[0,c.kI.required],maximumCost:[0,c.kI.required],dates:[null,c.kI.required],discountPercent:[0,c.kI.required],discountFlat:[0,c.kI.required],creditGift:[0,c.kI.required],isEnabled:[!0,c.kI.required],isFirstTravelOnly:[!1,c.kI.required]})}ngOnInit(){this.route.data.subscribe(t=>null!=t.coupon?this.form.patchValue(t.coupon.data.coupon):null)}onSubmit(){return(0,S.mG)(this,void 0,void 0,function*(){const t=this.form.value,{id:d,dates:z}=t,y=(0,S._T)(t,["id","dates"]),F=z[0].getTime(),x=z[1].getTime(),R=Object.assign(Object.assign({},y),{startAt:F,expireAt:x});null==d?yield(0,O.z)(this.createGQL.mutate({input:R})):yield(0,O.z)(this.updateGQL.mutate({id:d,input:R})),this.routerHelper.goToParent(this.route)})}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(C.gz),n.Y36(G.dD),n.Y36(c.qu),n.Y36(E.b),n.Y36(U.KW0),n.Y36(U.Ue1))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-coupon-view"]],decls:74,vars:9,consts:[["nzBackIcon","","nzTitle","Coupon","nzSubtitle","Definitions of coupons.",3,"nzGhost"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],["formControlName","id","type","hidden","hidden",""],[1,"lg:grid","lg:grid-cols-4","lg:gap-2"],["nzRequired","","nzFor","title"],["nz-input","","formControlName","title","id","title"],["nzRequired","","nzFor","code"],["nz-input","","formControlName","code","id","code"],["nzRequired","","nzFor","description"],["nz-input","","formControlName","description","id","description"],["nzRequired","","nzFor","manyUsersCanUse"],["formControlName","manyUsersCanUse","id","manyUsersCanUse"],["nzRequired","","nzFor","manyTimesUserCanUse"],["formControlName","manyTimesUserCanUse","id","manyTimesUserCanUse"],["nzRequired","","nzFor","minimumCost"],["formControlName","minimumCost","id","minimumCost"],["nzRequired","","nzFor","maximumCost"],["formControlName","maximumCost","id","maximumCost"],["id","dates","formControlName","dates",1,"w-full"],["nzRequired","","nzFor","discountPercent"],["formControlName","discountPercent","id","discountPercent"],["nzRequired","","nzFor","discountFlat"],["formControlName","discountFlat","id","discountFlat"],["nzRequired","","nzFor","creditGift"],["formControlName","creditGift","id","creditGift"],["nzFor","isEnabled"],["formControlName","isEnabled","id","isEnabled"],["nzFor","isFirstTravelOnly"],["formControlName","isFirstTravelOnly","id","isFirstTravelOnly"],["nz-button","","nzType","default","type","submit",1,"float-right",3,"disabled"]],template:function(t,d){1&t&&(n._UZ(0,"nz-page-header",0),n.TgZ(1,"nz-card")(2,"form",1),n.NdJ("ngSubmit",function(){return d.onSubmit()}),n._UZ(3,"input",2),n.TgZ(4,"div",3)(5,"nz-form-item")(6,"nz-form-label",4),n._uU(7,"Title"),n.qZA(),n.TgZ(8,"nz-form-control"),n._UZ(9,"input",5),n.qZA()(),n.TgZ(10,"nz-form-item")(11,"nz-form-label",6),n._uU(12,"Code"),n.qZA(),n.TgZ(13,"nz-form-control"),n._UZ(14,"input",7),n.qZA()(),n.TgZ(15,"nz-form-item")(16,"nz-form-label",8),n._uU(17,"Description"),n.qZA(),n.TgZ(18,"nz-form-control"),n._UZ(19,"input",9),n.qZA()(),n.TgZ(20,"nz-form-item")(21,"nz-form-label",10),n._uU(22,"# Users can use"),n.qZA(),n.TgZ(23,"nz-form-control"),n._UZ(24,"nz-input-number",11),n.qZA()(),n.TgZ(25,"nz-form-item")(26,"nz-form-label",12),n._uU(27,"# Times User Can Use"),n.qZA(),n.TgZ(28,"nz-form-control"),n._UZ(29,"nz-input-number",13),n.qZA()(),n.TgZ(30,"nz-form-item")(31,"nz-form-label",14),n._uU(32,"Minimum Cost"),n.qZA(),n.TgZ(33,"nz-form-control"),n._UZ(34,"nz-input-number",15),n.qZA()(),n.TgZ(35,"nz-form-item")(36,"nz-form-label",16),n._uU(37,"Maximum Cost"),n.qZA(),n.TgZ(38,"nz-form-control"),n._UZ(39,"nz-input-number",17),n.qZA()(),n.TgZ(40,"nz-form-item")(41,"nz-form-label",16),n._uU(42),n.ALo(43,"translate"),n.qZA(),n.TgZ(44,"nz-form-control"),n._UZ(45,"nz-range-picker",18),n.qZA()(),n.TgZ(46,"nz-form-item")(47,"nz-form-label",19),n._uU(48,"Discount Percent"),n.qZA(),n.TgZ(49,"nz-form-control"),n._UZ(50,"nz-input-number",20),n.qZA()(),n.TgZ(51,"nz-form-item")(52,"nz-form-label",21),n._uU(53,"Discount Flat"),n.qZA(),n.TgZ(54,"nz-form-control"),n._UZ(55,"nz-input-number",22),n.qZA()(),n.TgZ(56,"nz-form-item")(57,"nz-form-label",23),n._uU(58,"Credit Gift"),n.qZA(),n.TgZ(59,"nz-form-control"),n._UZ(60,"nz-input-number",24),n.qZA()(),n.TgZ(61,"nz-form-item")(62,"nz-form-label",25),n._uU(63,"Is Enabled?"),n.qZA(),n.TgZ(64,"nz-form-control"),n._UZ(65,"nz-switch",26),n.qZA()(),n.TgZ(66,"nz-form-item")(67,"nz-form-label",27),n._uU(68,"Is First Travel Only?"),n.qZA(),n.TgZ(69,"nz-form-control"),n._UZ(70,"nz-switch",28),n.qZA()()(),n.TgZ(71,"button",29),n._uU(72),n.ALo(73,"translate"),n.qZA()()()),2&t&&(n.Q6J("nzGhost",!1),n.xp6(2),n.Q6J("formGroup",d.form),n.xp6(40),n.Oqu(n.lcZ(43,5,"coupons.availabilityTime")),n.xp6(29),n.Q6J("disabled",d.form.invalid),n.xp6(1),n.hij(" ",n.lcZ(73,7,"profile.submit")," "))},directives:[T.$O,N.bd,c._Y,c.JL,b.Lr,c.sg,c.Fj,c.JJ,c.u,I.SK,b.Nx,I.t3,b.iK,b.Fd,$.Zp,w._,Q.uw,Q.wS,J.i,o.ix,i.dQ,l.w],pipes:[f.X$],styles:["nz-input-number[_ngcontent-%COMP%]{width:100%}"]}),e})(),D=(()=>{class e{constructor(t,d){this.paging=t,this.gql=d}resolve(t,d){const z=this.paging.deserializeQueryParams(t.queryParams);return this.gql.fetch(z)}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(g.w),n.LFG(U.YS$))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac}),e})(),j=(()=>{class e{constructor(t){this.gql=t}resolve(t,d){return this.gql.fetch({id:t.params.id})}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(U.Dog))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac}),e})();const M=[{path:"",component:h,resolve:{coupons:D},runGuardsAndResolvers:"paramsOrQueryParamsChange"},{path:"view/:id",component:P,resolve:{coupon:j}},{path:"new",component:P}];let Y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({providers:[D,j],imports:[[C.Bz.forChild(M)],C.Bz]}),e})();var V=r(6889);let B=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[v.ez,Y,V.m]]}),e})()}}]);